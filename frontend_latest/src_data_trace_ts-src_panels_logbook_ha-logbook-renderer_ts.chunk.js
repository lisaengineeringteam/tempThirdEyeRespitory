"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkhome_assistant_frontend"] = self["webpackChunkhome_assistant_frontend"] || []).push([["src_data_trace_ts-src_panels_logbook_ha-logbook-renderer_ts"],{

/***/ "./src/common/string/starts-with.ts":
/*!******************************************!*\
  !*** ./src/common/string/starts-with.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"strStartsWith\": () => (/* binding */ strStartsWith)\n/* harmony export */ });\nconst strStartsWith = (value, search) => value.substring(0, search.length) === search;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL3N0cmluZy9zdGFydHMtd2l0aC50cy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ob21lLWFzc2lzdGFudC1mcm9udGVuZC8uL3NyYy9jb21tb24vc3RyaW5nL3N0YXJ0cy13aXRoLnRzPzMzMTEiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHN0clN0YXJ0c1dpdGggPSAodmFsdWU6IHN0cmluZywgc2VhcmNoOiBzdHJpbmcpID0+XG4gIHZhbHVlLnN1YnN0cmluZygwLCBzZWFyY2gubGVuZ3RoKSA9PT0gc2VhcmNoO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/common/string/starts-with.ts\n");

/***/ }),

/***/ "./src/data/logbook.ts":
/*!*****************************!*\
  !*** ./src/data/logbook.ts ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__) => {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"CONTINUOUS_DOMAINS\": () => (/* binding */ CONTINUOUS_DOMAINS),\n/* harmony export */   \"getLogbookDataForContext\": () => (/* binding */ getLogbookDataForContext),\n/* harmony export */   \"getLogbookData\": () => (/* binding */ getLogbookData),\n/* harmony export */   \"subscribeLogbook\": () => (/* binding */ subscribeLogbook),\n/* harmony export */   \"clearLogbookCache\": () => (/* binding */ clearLogbookCache),\n/* harmony export */   \"createHistoricState\": () => (/* binding */ createHistoricState),\n/* harmony export */   \"localizeTriggerSource\": () => (/* binding */ localizeTriggerSource),\n/* harmony export */   \"localizeStateMessage\": () => (/* binding */ localizeStateMessage),\n/* harmony export */   \"filterLogbookCompatibleEntities\": () => (/* binding */ filterLogbookCompatibleEntities)\n/* harmony export */ });\n/* harmony import */ var _common_const__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/const */ \"./src/common/const.ts\");\n/* harmony import */ var _common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/entity/compute_domain */ \"./src/common/entity/compute_domain.ts\");\n/* harmony import */ var _common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/entity/compute_state_display */ \"./src/common/entity/compute_state_display.ts\");\n/* harmony import */ var _common_entity_compute_state_domain__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/entity/compute_state_domain */ \"./src/common/entity/compute_state_domain.ts\");\n/* harmony import */ var _entity__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./entity */ \"./src/data/entity.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_2__]);\n_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? await __webpack_async_dependencies__ : __webpack_async_dependencies__)[0];\n\n\n\n\n\nconst LOGBOOK_LOCALIZE_PATH = \"ui.components.logbook.messages\";\nconst CONTINUOUS_DOMAINS = [\"counter\", \"proximity\", \"sensor\"];\n//\n// Localization mapping for all the triggers in core\n// in homeassistant.components.homeassistant.triggers\n//\nconst triggerPhrases = {\n  \"numeric state of\": \"triggered_by_numeric_state_of\",\n  // number state trigger\n  \"state of\": \"triggered_by_state_of\",\n  // state trigger\n  event: \"triggered_by_event\",\n  // event trigger\n  time: \"triggered_by_time\",\n  // time trigger\n  \"time pattern\": \"triggered_by_time_pattern\",\n  // time trigger\n  \"Home Assistant stopping\": \"triggered_by_homeassistant_stopping\",\n  // stop event\n  \"Home Assistant starting\": \"triggered_by_homeassistant_starting\" // start event\n\n};\nconst DATA_CACHE = {};\nconst getLogbookDataForContext = async (hass, startDate, contextId) => {\n  await hass.loadBackendTranslation(\"device_class\");\n  return getLogbookDataFromServer(hass, startDate, undefined, undefined, contextId);\n};\nconst getLogbookData = async (hass, startDate, endDate, entityIds, deviceIds) => {\n  await hass.loadBackendTranslation(\"device_class\");\n  return deviceIds !== null && deviceIds !== void 0 && deviceIds.length ? getLogbookDataFromServer(hass, startDate, endDate, entityIds, undefined, deviceIds) : getLogbookDataCache(hass, startDate, endDate, entityIds);\n};\n\nconst getLogbookDataCache = async (hass, startDate, endDate, entityId) => {\n  const ALL_ENTITIES = \"*\";\n  const entityIdKey = entityId ? entityId.toString() : ALL_ENTITIES;\n  const cacheKey = `${startDate}${endDate}`;\n\n  if (!DATA_CACHE[cacheKey]) {\n    DATA_CACHE[cacheKey] = {};\n  }\n\n  if (entityIdKey in DATA_CACHE[cacheKey]) {\n    return DATA_CACHE[cacheKey][entityIdKey];\n  }\n\n  if (entityId && DATA_CACHE[cacheKey][ALL_ENTITIES]) {\n    const entities = await DATA_CACHE[cacheKey][ALL_ENTITIES];\n    return entities.filter(entity => entity.entity_id && entityId.includes(entity.entity_id));\n  }\n\n  DATA_CACHE[cacheKey][entityIdKey] = getLogbookDataFromServer(hass, startDate, endDate, entityId);\n  return DATA_CACHE[cacheKey][entityIdKey];\n};\n\nconst getLogbookDataFromServer = (hass, startDate, endDate, entityIds, contextId, deviceIds) => {\n  // If all specified filters are empty lists, we can return an empty list.\n  if ((entityIds || deviceIds) && (!entityIds || entityIds.length === 0) && (!deviceIds || deviceIds.length === 0)) {\n    return Promise.resolve([]);\n  }\n\n  const params = {\n    type: \"logbook/get_events\",\n    start_time: startDate\n  };\n\n  if (endDate) {\n    params.end_time = endDate;\n  }\n\n  if (entityIds !== null && entityIds !== void 0 && entityIds.length) {\n    params.entity_ids = entityIds;\n  }\n\n  if (deviceIds !== null && deviceIds !== void 0 && deviceIds.length) {\n    params.device_ids = deviceIds;\n  }\n\n  if (contextId) {\n    params.context_id = contextId;\n  }\n\n  return hass.callWS(params);\n};\n\nconst subscribeLogbook = (hass, callbackFunction, startDate, endDate, entityIds, deviceIds) => {\n  // If all specified filters are empty lists, we can return an empty list.\n  if ((entityIds || deviceIds) && (!entityIds || entityIds.length === 0) && (!deviceIds || deviceIds.length === 0)) {\n    return Promise.reject(\"No entities or devices\");\n  }\n\n  const params = {\n    type: \"logbook/event_stream\",\n    start_time: startDate,\n    end_time: endDate\n  };\n\n  if (entityIds !== null && entityIds !== void 0 && entityIds.length) {\n    params.entity_ids = entityIds;\n  }\n\n  if (deviceIds !== null && deviceIds !== void 0 && deviceIds.length) {\n    params.device_ids = deviceIds;\n  }\n\n  return hass.connection.subscribeMessage(message => callbackFunction(message), params);\n};\nconst clearLogbookCache = (startDate, endDate) => {\n  DATA_CACHE[`${startDate}${endDate}`] = {};\n};\nconst createHistoricState = (currentStateObj, state) => ({\n  entity_id: currentStateObj.entity_id,\n  state: state,\n  attributes: {\n    // Rebuild the historical state by copying static attributes only\n    device_class: currentStateObj === null || currentStateObj === void 0 ? void 0 : currentStateObj.attributes.device_class,\n    source_type: currentStateObj === null || currentStateObj === void 0 ? void 0 : currentStateObj.attributes.source_type,\n    has_date: currentStateObj === null || currentStateObj === void 0 ? void 0 : currentStateObj.attributes.has_date,\n    has_time: currentStateObj === null || currentStateObj === void 0 ? void 0 : currentStateObj.attributes.has_time,\n    // We do not want to use dynamic entity pictures (e.g., from media player) for the log book rendering,\n    // as they would present a false state in the log (played media right now vs actual historic data).\n    entity_picture_local: _common_const__WEBPACK_IMPORTED_MODULE_0__.DOMAINS_WITH_DYNAMIC_PICTURE.has((0,_common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_1__.computeDomain)(currentStateObj.entity_id)) ? undefined : currentStateObj === null || currentStateObj === void 0 ? void 0 : currentStateObj.attributes.entity_picture_local,\n    entity_picture: _common_const__WEBPACK_IMPORTED_MODULE_0__.DOMAINS_WITH_DYNAMIC_PICTURE.has((0,_common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_1__.computeDomain)(currentStateObj.entity_id)) ? undefined : currentStateObj === null || currentStateObj === void 0 ? void 0 : currentStateObj.attributes.entity_picture\n  }\n});\nconst localizeTriggerSource = (localize, source) => {\n  for (const triggerPhrase in triggerPhrases) {\n    if (source.startsWith(triggerPhrase)) {\n      return source.replace(triggerPhrase, `${localize(`ui.components.logbook.${triggerPhrases[triggerPhrase]}`)}`);\n    }\n  }\n\n  return source;\n};\nconst localizeStateMessage = (hass, localize, state, stateObj, domain) => {\n  switch (domain) {\n    case \"device_tracker\":\n    case \"person\":\n      if (state === \"not_home\") {\n        return localize(`${LOGBOOK_LOCALIZE_PATH}.was_away`);\n      }\n\n      if (state === \"home\") {\n        return localize(`${LOGBOOK_LOCALIZE_PATH}.was_at_home`);\n      }\n\n      return localize(`${LOGBOOK_LOCALIZE_PATH}.was_at_state`, \"state\", state);\n\n    case \"sun\":\n      return state === \"above_horizon\" ? localize(`${LOGBOOK_LOCALIZE_PATH}.rose`) : localize(`${LOGBOOK_LOCALIZE_PATH}.set`);\n\n    case \"binary_sensor\":\n      {\n        const isOn = state === _common_const__WEBPACK_IMPORTED_MODULE_0__.BINARY_STATE_ON;\n        const isOff = state === _common_const__WEBPACK_IMPORTED_MODULE_0__.BINARY_STATE_OFF;\n        const device_class = stateObj.attributes.device_class;\n\n        switch (device_class) {\n          case \"battery\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_low`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_normal`);\n            }\n\n            break;\n\n          case \"connectivity\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_connected`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_disconnected`);\n            }\n\n            break;\n\n          case \"door\":\n          case \"garage_door\":\n          case \"opening\":\n          case \"window\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_opened`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_closed`);\n            }\n\n            break;\n\n          case \"lock\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_unlocked`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_locked`);\n            }\n\n            break;\n\n          case \"plug\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_plugged_in`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_unplugged`);\n            }\n\n            break;\n\n          case \"presence\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_at_home`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_away`);\n            }\n\n            break;\n\n          case \"safety\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_unsafe`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.was_safe`);\n            }\n\n            break;\n\n          case \"cold\":\n          case \"gas\":\n          case \"heat\":\n          case \"moisture\":\n          case \"motion\":\n          case \"occupancy\":\n          case \"power\":\n          case \"problem\":\n          case \"smoke\":\n          case \"sound\":\n          case \"vibration\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.detected_device_class`, {\n                device_class: localize(`component.binary_sensor.device_class.${device_class}`)\n              });\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.cleared_device_class`, {\n                device_class: localize(`component.binary_sensor.device_class.${device_class}`)\n              });\n            }\n\n            break;\n\n          case \"tamper\":\n            if (isOn) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.detected_tampering`);\n            }\n\n            if (isOff) {\n              return localize(`${LOGBOOK_LOCALIZE_PATH}.cleared_tampering`);\n            }\n\n            break;\n        }\n\n        break;\n      }\n\n    case \"cover\":\n      switch (state) {\n        case \"open\":\n          return localize(`${LOGBOOK_LOCALIZE_PATH}.was_opened`);\n\n        case \"opening\":\n          return localize(`${LOGBOOK_LOCALIZE_PATH}.is_opening`);\n\n        case \"closing\":\n          return localize(`${LOGBOOK_LOCALIZE_PATH}.is_closing`);\n\n        case \"closed\":\n          return localize(`${LOGBOOK_LOCALIZE_PATH}.was_closed`);\n      }\n\n      break;\n\n    case \"lock\":\n      if (state === \"unlocked\") {\n        return localize(`${LOGBOOK_LOCALIZE_PATH}.was_unlocked`);\n      }\n\n      if (state === \"locked\") {\n        return localize(`${LOGBOOK_LOCALIZE_PATH}.was_locked`);\n      }\n\n      break;\n  }\n\n  if (state === _common_const__WEBPACK_IMPORTED_MODULE_0__.BINARY_STATE_ON) {\n    return localize(`${LOGBOOK_LOCALIZE_PATH}.turned_on`);\n  }\n\n  if (state === _common_const__WEBPACK_IMPORTED_MODULE_0__.BINARY_STATE_OFF) {\n    return localize(`${LOGBOOK_LOCALIZE_PATH}.turned_off`);\n  }\n\n  if (_entity__WEBPACK_IMPORTED_MODULE_4__.UNAVAILABLE_STATES.includes(state)) {\n    return localize(`${LOGBOOK_LOCALIZE_PATH}.became_unavailable`);\n  }\n\n  return hass.localize(`${LOGBOOK_LOCALIZE_PATH}.changed_to_state`, \"state\", stateObj ? (0,_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_2__.computeStateDisplay)(localize, stateObj, hass.locale, state) : state);\n};\nconst filterLogbookCompatibleEntities = entity => (0,_common_entity_compute_state_domain__WEBPACK_IMPORTED_MODULE_3__.computeStateDomain)(entity) !== \"sensor\" || entity.attributes.unit_of_measurement === undefined && entity.attributes.state_class === undefined;\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9sb2dib29rLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBQ0E7QUFpQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOztBQVBBO0FBVUE7QUFJQTtBQUtBO0FBQ0E7QUFPQTtBQUVBO0FBT0E7QUFDQTtBQVVBOztBQUVBO0FBTUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBR0E7O0FBRUE7QUFNQTtBQUNBOztBQUVBO0FBUUE7QUFDQTtBQUtBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRkE7O0FBSUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7QUFRQTtBQUNBO0FBS0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBOztBQUtBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBYkE7QUFIQTtBQXdCQTtBQUlBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFFQTtBQUNBOztBQUlBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBS0E7O0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFLQTs7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFyR0E7O0FBd0dBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFSQTs7QUFVQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFwSkE7O0FBdUpBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBT0E7QUFFQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2RhdGEvbG9nYm9vay50cz80MGQzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEhhc3NFbnRpdHkgfSBmcm9tIFwiaG9tZS1hc3Npc3RhbnQtanMtd2Vic29ja2V0XCI7XG5pbXBvcnQge1xuICBCSU5BUllfU1RBVEVfT0ZGLFxuICBCSU5BUllfU1RBVEVfT04sXG4gIERPTUFJTlNfV0lUSF9EWU5BTUlDX1BJQ1RVUkUsXG59IGZyb20gXCIuLi9jb21tb24vY29uc3RcIjtcbmltcG9ydCB7IGNvbXB1dGVEb21haW4gfSBmcm9tIFwiLi4vY29tbW9uL2VudGl0eS9jb21wdXRlX2RvbWFpblwiO1xuaW1wb3J0IHsgY29tcHV0ZVN0YXRlRGlzcGxheSB9IGZyb20gXCIuLi9jb21tb24vZW50aXR5L2NvbXB1dGVfc3RhdGVfZGlzcGxheVwiO1xuaW1wb3J0IHsgY29tcHV0ZVN0YXRlRG9tYWluIH0gZnJvbSBcIi4uL2NvbW1vbi9lbnRpdHkvY29tcHV0ZV9zdGF0ZV9kb21haW5cIjtcbmltcG9ydCB7IExvY2FsaXplRnVuYyB9IGZyb20gXCIuLi9jb21tb24vdHJhbnNsYXRpb25zL2xvY2FsaXplXCI7XG5pbXBvcnQgeyBIYUVudGl0eVBpY2tlckVudGl0eUZpbHRlckZ1bmMgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9lbnRpdHkvaGEtZW50aXR5LXBpY2tlclwiO1xuaW1wb3J0IHsgSG9tZUFzc2lzdGFudCB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgVU5BVkFJTEFCTEVfU1RBVEVTIH0gZnJvbSBcIi4vZW50aXR5XCI7XG5cbmNvbnN0IExPR0JPT0tfTE9DQUxJWkVfUEFUSCA9IFwidWkuY29tcG9uZW50cy5sb2dib29rLm1lc3NhZ2VzXCI7XG5leHBvcnQgY29uc3QgQ09OVElOVU9VU19ET01BSU5TID0gW1wiY291bnRlclwiLCBcInByb3hpbWl0eVwiLCBcInNlbnNvclwiXTtcblxuZXhwb3J0IGludGVyZmFjZSBMb2dib29rU3RyZWFtTWVzc2FnZSB7XG4gIGV2ZW50czogTG9nYm9va0VudHJ5W107XG4gIHN0YXJ0X3RpbWU/OiBudW1iZXI7IC8vIFN0YXJ0IHRpbWUgb2YgdGhpcyBoaXN0b3JpY2FsIGNodW5rXG4gIGVuZF90aW1lPzogbnVtYmVyOyAvLyBFbmQgdGltZSBvZiB0aGlzIGhpc3RvcmljYWwgY2h1bmtcbiAgcGFydGlhbD86IGJvb2xlYW47IC8vIEluZGljaWF0ZXMgbW9yZSBoaXN0b3JpY2FsIGNodW5rcyBhcmUgY29taW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9nYm9va0VudHJ5IHtcbiAgLy8gQmFzZSBkYXRhXG4gIHdoZW46IG51bWJlcjsgLy8gUHl0aG9uIHRpbWVzdGFtcC4gRG8gKjEwMDAgdG8gZ2V0IEpTIHRpbWVzdGFtcC5cbiAgbmFtZTogc3RyaW5nO1xuICBtZXNzYWdlPzogc3RyaW5nO1xuICBlbnRpdHlfaWQ/OiBzdHJpbmc7XG4gIGljb24/OiBzdHJpbmc7XG4gIHNvdXJjZT86IHN0cmluZzsgLy8gVGhlIHRyaWdnZXIgc291cmNlXG4gIGRvbWFpbj86IHN0cmluZztcbiAgc3RhdGU/OiBzdHJpbmc7IC8vIFRoZSBzdGF0ZSBvZiB0aGUgZW50aXR5XG4gIC8vIENvbnRleHQgZGF0YVxuICBjb250ZXh0X2lkPzogc3RyaW5nO1xuICBjb250ZXh0X3VzZXJfaWQ/OiBzdHJpbmc7XG4gIGNvbnRleHRfZXZlbnRfdHlwZT86IHN0cmluZztcbiAgY29udGV4dF9kb21haW4/OiBzdHJpbmc7XG4gIGNvbnRleHRfc2VydmljZT86IHN0cmluZzsgLy8gU2VydmljZSBjYWxscyBvbmx5XG4gIGNvbnRleHRfZW50aXR5X2lkPzogc3RyaW5nO1xuICBjb250ZXh0X2VudGl0eV9pZF9uYW1lPzogc3RyaW5nOyAvLyBMZWdhY3ksIG5vdCBsb25nZXIgc2VudFxuICBjb250ZXh0X25hbWU/OiBzdHJpbmc7XG4gIGNvbnRleHRfc3RhdGU/OiBzdHJpbmc7IC8vIFRoZSBzdGF0ZSBvZiB0aGUgZW50aXR5XG4gIGNvbnRleHRfc291cmNlPzogc3RyaW5nOyAvLyBUaGUgdHJpZ2dlciBzb3VyY2VcbiAgY29udGV4dF9tZXNzYWdlPzogc3RyaW5nO1xufVxuXG4vL1xuLy8gTG9jYWxpemF0aW9uIG1hcHBpbmcgZm9yIGFsbCB0aGUgdHJpZ2dlcnMgaW4gY29yZVxuLy8gaW4gaG9tZWFzc2lzdGFudC5jb21wb25lbnRzLmhvbWVhc3Npc3RhbnQudHJpZ2dlcnNcbi8vXG5jb25zdCB0cmlnZ2VyUGhyYXNlcyA9IHtcbiAgXCJudW1lcmljIHN0YXRlIG9mXCI6IFwidHJpZ2dlcmVkX2J5X251bWVyaWNfc3RhdGVfb2ZcIiwgLy8gbnVtYmVyIHN0YXRlIHRyaWdnZXJcbiAgXCJzdGF0ZSBvZlwiOiBcInRyaWdnZXJlZF9ieV9zdGF0ZV9vZlwiLCAvLyBzdGF0ZSB0cmlnZ2VyXG4gIGV2ZW50OiBcInRyaWdnZXJlZF9ieV9ldmVudFwiLCAvLyBldmVudCB0cmlnZ2VyXG4gIHRpbWU6IFwidHJpZ2dlcmVkX2J5X3RpbWVcIiwgLy8gdGltZSB0cmlnZ2VyXG4gIFwidGltZSBwYXR0ZXJuXCI6IFwidHJpZ2dlcmVkX2J5X3RpbWVfcGF0dGVyblwiLCAvLyB0aW1lIHRyaWdnZXJcbiAgXCJIb21lIEFzc2lzdGFudCBzdG9wcGluZ1wiOiBcInRyaWdnZXJlZF9ieV9ob21lYXNzaXN0YW50X3N0b3BwaW5nXCIsIC8vIHN0b3AgZXZlbnRcbiAgXCJIb21lIEFzc2lzdGFudCBzdGFydGluZ1wiOiBcInRyaWdnZXJlZF9ieV9ob21lYXNzaXN0YW50X3N0YXJ0aW5nXCIsIC8vIHN0YXJ0IGV2ZW50XG59O1xuXG5jb25zdCBEQVRBX0NBQ0hFOiB7XG4gIFtjYWNoZUtleTogc3RyaW5nXTogeyBbZW50aXR5SWQ6IHN0cmluZ106IFByb21pc2U8TG9nYm9va0VudHJ5W10+IH07XG59ID0ge307XG5cbmV4cG9ydCBjb25zdCBnZXRMb2dib29rRGF0YUZvckNvbnRleHQgPSBhc3luYyAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHN0YXJ0RGF0ZTogc3RyaW5nLFxuICBjb250ZXh0SWQ/OiBzdHJpbmdcbik6IFByb21pc2U8TG9nYm9va0VudHJ5W10+ID0+IHtcbiAgYXdhaXQgaGFzcy5sb2FkQmFja2VuZFRyYW5zbGF0aW9uKFwiZGV2aWNlX2NsYXNzXCIpO1xuICByZXR1cm4gZ2V0TG9nYm9va0RhdGFGcm9tU2VydmVyKFxuICAgIGhhc3MsXG4gICAgc3RhcnREYXRlLFxuICAgIHVuZGVmaW5lZCxcbiAgICB1bmRlZmluZWQsXG4gICAgY29udGV4dElkXG4gICk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0TG9nYm9va0RhdGEgPSBhc3luYyAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHN0YXJ0RGF0ZTogc3RyaW5nLFxuICBlbmREYXRlOiBzdHJpbmcsXG4gIGVudGl0eUlkcz86IHN0cmluZ1tdLFxuICBkZXZpY2VJZHM/OiBzdHJpbmdbXVxuKTogUHJvbWlzZTxMb2dib29rRW50cnlbXT4gPT4ge1xuICBhd2FpdCBoYXNzLmxvYWRCYWNrZW5kVHJhbnNsYXRpb24oXCJkZXZpY2VfY2xhc3NcIik7XG4gIHJldHVybiBkZXZpY2VJZHM/Lmxlbmd0aFxuICAgID8gZ2V0TG9nYm9va0RhdGFGcm9tU2VydmVyKFxuICAgICAgICBoYXNzLFxuICAgICAgICBzdGFydERhdGUsXG4gICAgICAgIGVuZERhdGUsXG4gICAgICAgIGVudGl0eUlkcyxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBkZXZpY2VJZHNcbiAgICAgIClcbiAgICA6IGdldExvZ2Jvb2tEYXRhQ2FjaGUoaGFzcywgc3RhcnREYXRlLCBlbmREYXRlLCBlbnRpdHlJZHMpO1xufTtcblxuY29uc3QgZ2V0TG9nYm9va0RhdGFDYWNoZSA9IGFzeW5jIChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgc3RhcnREYXRlOiBzdHJpbmcsXG4gIGVuZERhdGU6IHN0cmluZyxcbiAgZW50aXR5SWQ/OiBzdHJpbmdbXVxuKSA9PiB7XG4gIGNvbnN0IEFMTF9FTlRJVElFUyA9IFwiKlwiO1xuXG4gIGNvbnN0IGVudGl0eUlkS2V5ID0gZW50aXR5SWQgPyBlbnRpdHlJZC50b1N0cmluZygpIDogQUxMX0VOVElUSUVTO1xuICBjb25zdCBjYWNoZUtleSA9IGAke3N0YXJ0RGF0ZX0ke2VuZERhdGV9YDtcblxuICBpZiAoIURBVEFfQ0FDSEVbY2FjaGVLZXldKSB7XG4gICAgREFUQV9DQUNIRVtjYWNoZUtleV0gPSB7fTtcbiAgfVxuXG4gIGlmIChlbnRpdHlJZEtleSBpbiBEQVRBX0NBQ0hFW2NhY2hlS2V5XSkge1xuICAgIHJldHVybiBEQVRBX0NBQ0hFW2NhY2hlS2V5XVtlbnRpdHlJZEtleV07XG4gIH1cblxuICBpZiAoZW50aXR5SWQgJiYgREFUQV9DQUNIRVtjYWNoZUtleV1bQUxMX0VOVElUSUVTXSkge1xuICAgIGNvbnN0IGVudGl0aWVzID0gYXdhaXQgREFUQV9DQUNIRVtjYWNoZUtleV1bQUxMX0VOVElUSUVTXTtcbiAgICByZXR1cm4gZW50aXRpZXMuZmlsdGVyKFxuICAgICAgKGVudGl0eSkgPT4gZW50aXR5LmVudGl0eV9pZCAmJiBlbnRpdHlJZC5pbmNsdWRlcyhlbnRpdHkuZW50aXR5X2lkKVxuICAgICk7XG4gIH1cblxuICBEQVRBX0NBQ0hFW2NhY2hlS2V5XVtlbnRpdHlJZEtleV0gPSBnZXRMb2dib29rRGF0YUZyb21TZXJ2ZXIoXG4gICAgaGFzcyxcbiAgICBzdGFydERhdGUsXG4gICAgZW5kRGF0ZSxcbiAgICBlbnRpdHlJZFxuICApO1xuICByZXR1cm4gREFUQV9DQUNIRVtjYWNoZUtleV1bZW50aXR5SWRLZXldO1xufTtcblxuY29uc3QgZ2V0TG9nYm9va0RhdGFGcm9tU2VydmVyID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBzdGFydERhdGU6IHN0cmluZyxcbiAgZW5kRGF0ZT86IHN0cmluZyxcbiAgZW50aXR5SWRzPzogc3RyaW5nW10sXG4gIGNvbnRleHRJZD86IHN0cmluZyxcbiAgZGV2aWNlSWRzPzogc3RyaW5nW11cbik6IFByb21pc2U8TG9nYm9va0VudHJ5W10+ID0+IHtcbiAgLy8gSWYgYWxsIHNwZWNpZmllZCBmaWx0ZXJzIGFyZSBlbXB0eSBsaXN0cywgd2UgY2FuIHJldHVybiBhbiBlbXB0eSBsaXN0LlxuICBpZiAoXG4gICAgKGVudGl0eUlkcyB8fCBkZXZpY2VJZHMpICYmXG4gICAgKCFlbnRpdHlJZHMgfHwgZW50aXR5SWRzLmxlbmd0aCA9PT0gMCkgJiZcbiAgICAoIWRldmljZUlkcyB8fCBkZXZpY2VJZHMubGVuZ3RoID09PSAwKVxuICApIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtdKTtcbiAgfVxuXG4gIGNvbnN0IHBhcmFtczogYW55ID0ge1xuICAgIHR5cGU6IFwibG9nYm9vay9nZXRfZXZlbnRzXCIsXG4gICAgc3RhcnRfdGltZTogc3RhcnREYXRlLFxuICB9O1xuICBpZiAoZW5kRGF0ZSkge1xuICAgIHBhcmFtcy5lbmRfdGltZSA9IGVuZERhdGU7XG4gIH1cbiAgaWYgKGVudGl0eUlkcz8ubGVuZ3RoKSB7XG4gICAgcGFyYW1zLmVudGl0eV9pZHMgPSBlbnRpdHlJZHM7XG4gIH1cbiAgaWYgKGRldmljZUlkcz8ubGVuZ3RoKSB7XG4gICAgcGFyYW1zLmRldmljZV9pZHMgPSBkZXZpY2VJZHM7XG4gIH1cbiAgaWYgKGNvbnRleHRJZCkge1xuICAgIHBhcmFtcy5jb250ZXh0X2lkID0gY29udGV4dElkO1xuICB9XG4gIHJldHVybiBoYXNzLmNhbGxXUzxMb2dib29rRW50cnlbXT4ocGFyYW1zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBzdWJzY3JpYmVMb2dib29rID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBjYWxsYmFja0Z1bmN0aW9uOiAobWVzc2FnZTogTG9nYm9va1N0cmVhbU1lc3NhZ2UpID0+IHZvaWQsXG4gIHN0YXJ0RGF0ZTogc3RyaW5nLFxuICBlbmREYXRlOiBzdHJpbmcsXG4gIGVudGl0eUlkcz86IHN0cmluZ1tdLFxuICBkZXZpY2VJZHM/OiBzdHJpbmdbXVxuKTogUHJvbWlzZTwoKSA9PiBQcm9taXNlPHZvaWQ+PiA9PiB7XG4gIC8vIElmIGFsbCBzcGVjaWZpZWQgZmlsdGVycyBhcmUgZW1wdHkgbGlzdHMsIHdlIGNhbiByZXR1cm4gYW4gZW1wdHkgbGlzdC5cbiAgaWYgKFxuICAgIChlbnRpdHlJZHMgfHwgZGV2aWNlSWRzKSAmJlxuICAgICghZW50aXR5SWRzIHx8IGVudGl0eUlkcy5sZW5ndGggPT09IDApICYmXG4gICAgKCFkZXZpY2VJZHMgfHwgZGV2aWNlSWRzLmxlbmd0aCA9PT0gMClcbiAgKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiTm8gZW50aXRpZXMgb3IgZGV2aWNlc1wiKTtcbiAgfVxuICBjb25zdCBwYXJhbXM6IGFueSA9IHtcbiAgICB0eXBlOiBcImxvZ2Jvb2svZXZlbnRfc3RyZWFtXCIsXG4gICAgc3RhcnRfdGltZTogc3RhcnREYXRlLFxuICAgIGVuZF90aW1lOiBlbmREYXRlLFxuICB9O1xuICBpZiAoZW50aXR5SWRzPy5sZW5ndGgpIHtcbiAgICBwYXJhbXMuZW50aXR5X2lkcyA9IGVudGl0eUlkcztcbiAgfVxuICBpZiAoZGV2aWNlSWRzPy5sZW5ndGgpIHtcbiAgICBwYXJhbXMuZGV2aWNlX2lkcyA9IGRldmljZUlkcztcbiAgfVxuICByZXR1cm4gaGFzcy5jb25uZWN0aW9uLnN1YnNjcmliZU1lc3NhZ2U8TG9nYm9va1N0cmVhbU1lc3NhZ2U+KFxuICAgIChtZXNzYWdlKSA9PiBjYWxsYmFja0Z1bmN0aW9uKG1lc3NhZ2UpLFxuICAgIHBhcmFtc1xuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IGNsZWFyTG9nYm9va0NhY2hlID0gKHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpID0+IHtcbiAgREFUQV9DQUNIRVtgJHtzdGFydERhdGV9JHtlbmREYXRlfWBdID0ge307XG59O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlSGlzdG9yaWNTdGF0ZSA9IChcbiAgY3VycmVudFN0YXRlT2JqOiBIYXNzRW50aXR5LFxuICBzdGF0ZT86IHN0cmluZ1xuKTogSGFzc0VudGl0eSA9PiA8SGFzc0VudGl0eT4oPHVua25vd24+e1xuICAgIGVudGl0eV9pZDogY3VycmVudFN0YXRlT2JqLmVudGl0eV9pZCxcbiAgICBzdGF0ZTogc3RhdGUsXG4gICAgYXR0cmlidXRlczoge1xuICAgICAgLy8gUmVidWlsZCB0aGUgaGlzdG9yaWNhbCBzdGF0ZSBieSBjb3B5aW5nIHN0YXRpYyBhdHRyaWJ1dGVzIG9ubHlcbiAgICAgIGRldmljZV9jbGFzczogY3VycmVudFN0YXRlT2JqPy5hdHRyaWJ1dGVzLmRldmljZV9jbGFzcyxcbiAgICAgIHNvdXJjZV90eXBlOiBjdXJyZW50U3RhdGVPYmo/LmF0dHJpYnV0ZXMuc291cmNlX3R5cGUsXG4gICAgICBoYXNfZGF0ZTogY3VycmVudFN0YXRlT2JqPy5hdHRyaWJ1dGVzLmhhc19kYXRlLFxuICAgICAgaGFzX3RpbWU6IGN1cnJlbnRTdGF0ZU9iaj8uYXR0cmlidXRlcy5oYXNfdGltZSxcbiAgICAgIC8vIFdlIGRvIG5vdCB3YW50IHRvIHVzZSBkeW5hbWljIGVudGl0eSBwaWN0dXJlcyAoZS5nLiwgZnJvbSBtZWRpYSBwbGF5ZXIpIGZvciB0aGUgbG9nIGJvb2sgcmVuZGVyaW5nLFxuICAgICAgLy8gYXMgdGhleSB3b3VsZCBwcmVzZW50IGEgZmFsc2Ugc3RhdGUgaW4gdGhlIGxvZyAocGxheWVkIG1lZGlhIHJpZ2h0IG5vdyB2cyBhY3R1YWwgaGlzdG9yaWMgZGF0YSkuXG4gICAgICBlbnRpdHlfcGljdHVyZV9sb2NhbDogRE9NQUlOU19XSVRIX0RZTkFNSUNfUElDVFVSRS5oYXMoXG4gICAgICAgIGNvbXB1dGVEb21haW4oY3VycmVudFN0YXRlT2JqLmVudGl0eV9pZClcbiAgICAgIClcbiAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgOiBjdXJyZW50U3RhdGVPYmo/LmF0dHJpYnV0ZXMuZW50aXR5X3BpY3R1cmVfbG9jYWwsXG4gICAgICBlbnRpdHlfcGljdHVyZTogRE9NQUlOU19XSVRIX0RZTkFNSUNfUElDVFVSRS5oYXMoXG4gICAgICAgIGNvbXB1dGVEb21haW4oY3VycmVudFN0YXRlT2JqLmVudGl0eV9pZClcbiAgICAgIClcbiAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgOiBjdXJyZW50U3RhdGVPYmo/LmF0dHJpYnV0ZXMuZW50aXR5X3BpY3R1cmUsXG4gICAgfSxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBsb2NhbGl6ZVRyaWdnZXJTb3VyY2UgPSAoXG4gIGxvY2FsaXplOiBMb2NhbGl6ZUZ1bmMsXG4gIHNvdXJjZTogc3RyaW5nXG4pID0+IHtcbiAgZm9yIChjb25zdCB0cmlnZ2VyUGhyYXNlIGluIHRyaWdnZXJQaHJhc2VzKSB7XG4gICAgaWYgKHNvdXJjZS5zdGFydHNXaXRoKHRyaWdnZXJQaHJhc2UpKSB7XG4gICAgICByZXR1cm4gc291cmNlLnJlcGxhY2UoXG4gICAgICAgIHRyaWdnZXJQaHJhc2UsXG4gICAgICAgIGAke2xvY2FsaXplKGB1aS5jb21wb25lbnRzLmxvZ2Jvb2suJHt0cmlnZ2VyUGhyYXNlc1t0cmlnZ2VyUGhyYXNlXX1gKX1gXG4gICAgICApO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc291cmNlO1xufTtcblxuZXhwb3J0IGNvbnN0IGxvY2FsaXplU3RhdGVNZXNzYWdlID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBsb2NhbGl6ZTogTG9jYWxpemVGdW5jLFxuICBzdGF0ZTogc3RyaW5nLFxuICBzdGF0ZU9iajogSGFzc0VudGl0eSxcbiAgZG9tYWluOiBzdHJpbmdcbik6IHN0cmluZyA9PiB7XG4gIHN3aXRjaCAoZG9tYWluKSB7XG4gICAgY2FzZSBcImRldmljZV90cmFja2VyXCI6XG4gICAgY2FzZSBcInBlcnNvblwiOlxuICAgICAgaWYgKHN0YXRlID09PSBcIm5vdF9ob21lXCIpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX2F3YXlgKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZSA9PT0gXCJob21lXCIpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX2F0X2hvbWVgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc19hdF9zdGF0ZWAsIFwic3RhdGVcIiwgc3RhdGUpO1xuXG4gICAgY2FzZSBcInN1blwiOlxuICAgICAgcmV0dXJuIHN0YXRlID09PSBcImFib3ZlX2hvcml6b25cIlxuICAgICAgICA/IGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ucm9zZWApXG4gICAgICAgIDogbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS5zZXRgKTtcblxuICAgIGNhc2UgXCJiaW5hcnlfc2Vuc29yXCI6IHtcbiAgICAgIGNvbnN0IGlzT24gPSBzdGF0ZSA9PT0gQklOQVJZX1NUQVRFX09OO1xuICAgICAgY29uc3QgaXNPZmYgPSBzdGF0ZSA9PT0gQklOQVJZX1NUQVRFX09GRjtcbiAgICAgIGNvbnN0IGRldmljZV9jbGFzcyA9IHN0YXRlT2JqLmF0dHJpYnV0ZXMuZGV2aWNlX2NsYXNzO1xuXG4gICAgICBzd2l0Y2ggKGRldmljZV9jbGFzcykge1xuICAgICAgICBjYXNlIFwiYmF0dGVyeVwiOlxuICAgICAgICAgIGlmIChpc09uKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS53YXNfbG93YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpc09mZikge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX25vcm1hbGApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIFwiY29ubmVjdGl2aXR5XCI6XG4gICAgICAgICAgaWYgKGlzT24pIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc19jb25uZWN0ZWRgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGlzT2ZmKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS53YXNfZGlzY29ubmVjdGVkYCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJkb29yXCI6XG4gICAgICAgIGNhc2UgXCJnYXJhZ2VfZG9vclwiOlxuICAgICAgICBjYXNlIFwib3BlbmluZ1wiOlxuICAgICAgICBjYXNlIFwid2luZG93XCI6XG4gICAgICAgICAgaWYgKGlzT24pIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc19vcGVuZWRgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGlzT2ZmKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS53YXNfY2xvc2VkYCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJsb2NrXCI6XG4gICAgICAgICAgaWYgKGlzT24pIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc191bmxvY2tlZGApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaXNPZmYpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc19sb2NrZWRgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBcInBsdWdcIjpcbiAgICAgICAgICBpZiAoaXNPbikge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX3BsdWdnZWRfaW5gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGlzT2ZmKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS53YXNfdW5wbHVnZ2VkYCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJwcmVzZW5jZVwiOlxuICAgICAgICAgIGlmIChpc09uKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS53YXNfYXRfaG9tZWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaXNPZmYpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc19hd2F5YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJzYWZldHlcIjpcbiAgICAgICAgICBpZiAoaXNPbikge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX3Vuc2FmZWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaXNPZmYpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc19zYWZlYCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJjb2xkXCI6XG4gICAgICAgIGNhc2UgXCJnYXNcIjpcbiAgICAgICAgY2FzZSBcImhlYXRcIjpcbiAgICAgICAgY2FzZSBcIm1vaXN0dXJlXCI6XG4gICAgICAgIGNhc2UgXCJtb3Rpb25cIjpcbiAgICAgICAgY2FzZSBcIm9jY3VwYW5jeVwiOlxuICAgICAgICBjYXNlIFwicG93ZXJcIjpcbiAgICAgICAgY2FzZSBcInByb2JsZW1cIjpcbiAgICAgICAgY2FzZSBcInNtb2tlXCI6XG4gICAgICAgIGNhc2UgXCJzb3VuZFwiOlxuICAgICAgICBjYXNlIFwidmlicmF0aW9uXCI6XG4gICAgICAgICAgaWYgKGlzT24pIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9LmRldGVjdGVkX2RldmljZV9jbGFzc2AsIHtcbiAgICAgICAgICAgICAgZGV2aWNlX2NsYXNzOiBsb2NhbGl6ZShcbiAgICAgICAgICAgICAgICBgY29tcG9uZW50LmJpbmFyeV9zZW5zb3IuZGV2aWNlX2NsYXNzLiR7ZGV2aWNlX2NsYXNzfWBcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaXNPZmYpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9LmNsZWFyZWRfZGV2aWNlX2NsYXNzYCwge1xuICAgICAgICAgICAgICBkZXZpY2VfY2xhc3M6IGxvY2FsaXplKFxuICAgICAgICAgICAgICAgIGBjb21wb25lbnQuYmluYXJ5X3NlbnNvci5kZXZpY2VfY2xhc3MuJHtkZXZpY2VfY2xhc3N9YFxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJ0YW1wZXJcIjpcbiAgICAgICAgICBpZiAoaXNPbikge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0uZGV0ZWN0ZWRfdGFtcGVyaW5nYCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpc09mZikge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0uY2xlYXJlZF90YW1wZXJpbmdgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGNhc2UgXCJjb3ZlclwiOlxuICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICBjYXNlIFwib3BlblwiOlxuICAgICAgICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9Lndhc19vcGVuZWRgKTtcbiAgICAgICAgY2FzZSBcIm9wZW5pbmdcIjpcbiAgICAgICAgICByZXR1cm4gbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS5pc19vcGVuaW5nYCk7XG4gICAgICAgIGNhc2UgXCJjbG9zaW5nXCI6XG4gICAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0uaXNfY2xvc2luZ2ApO1xuICAgICAgICBjYXNlIFwiY2xvc2VkXCI6XG4gICAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX2Nsb3NlZGApO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIFwibG9ja1wiOlxuICAgICAgaWYgKHN0YXRlID09PSBcInVubG9ja2VkXCIpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX3VubG9ja2VkYCk7XG4gICAgICB9XG4gICAgICBpZiAoc3RhdGUgPT09IFwibG9ja2VkXCIpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0ud2FzX2xvY2tlZGApO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH1cblxuICBpZiAoc3RhdGUgPT09IEJJTkFSWV9TVEFURV9PTikge1xuICAgIHJldHVybiBsb2NhbGl6ZShgJHtMT0dCT09LX0xPQ0FMSVpFX1BBVEh9LnR1cm5lZF9vbmApO1xuICB9XG5cbiAgaWYgKHN0YXRlID09PSBCSU5BUllfU1RBVEVfT0ZGKSB7XG4gICAgcmV0dXJuIGxvY2FsaXplKGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0udHVybmVkX29mZmApO1xuICB9XG5cbiAgaWYgKFVOQVZBSUxBQkxFX1NUQVRFUy5pbmNsdWRlcyhzdGF0ZSkpIHtcbiAgICByZXR1cm4gbG9jYWxpemUoYCR7TE9HQk9PS19MT0NBTElaRV9QQVRIfS5iZWNhbWVfdW5hdmFpbGFibGVgKTtcbiAgfVxuXG4gIHJldHVybiBoYXNzLmxvY2FsaXplKFxuICAgIGAke0xPR0JPT0tfTE9DQUxJWkVfUEFUSH0uY2hhbmdlZF90b19zdGF0ZWAsXG4gICAgXCJzdGF0ZVwiLFxuICAgIHN0YXRlT2JqXG4gICAgICA/IGNvbXB1dGVTdGF0ZURpc3BsYXkobG9jYWxpemUsIHN0YXRlT2JqLCBoYXNzLmxvY2FsZSwgc3RhdGUpXG4gICAgICA6IHN0YXRlXG4gICk7XG59O1xuXG5leHBvcnQgY29uc3QgZmlsdGVyTG9nYm9va0NvbXBhdGlibGVFbnRpdGllczogSGFFbnRpdHlQaWNrZXJFbnRpdHlGaWx0ZXJGdW5jID0gKFxuICBlbnRpdHlcbikgPT5cbiAgY29tcHV0ZVN0YXRlRG9tYWluKGVudGl0eSkgIT09IFwic2Vuc29yXCIgfHxcbiAgKGVudGl0eS5hdHRyaWJ1dGVzLnVuaXRfb2ZfbWVhc3VyZW1lbnQgPT09IHVuZGVmaW5lZCAmJlxuICAgIGVudGl0eS5hdHRyaWJ1dGVzLnN0YXRlX2NsYXNzID09PSB1bmRlZmluZWQpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/data/logbook.ts\n");

/***/ }),

/***/ "./src/data/trace.ts":
/*!***************************!*\
  !*** ./src/data/trace.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"loadTrace\": () => (/* binding */ loadTrace),\n/* harmony export */   \"loadTraces\": () => (/* binding */ loadTraces),\n/* harmony export */   \"loadTraceContexts\": () => (/* binding */ loadTraceContexts),\n/* harmony export */   \"getDataFromPath\": () => (/* binding */ getDataFromPath),\n/* harmony export */   \"isTriggerPath\": () => (/* binding */ isTriggerPath),\n/* harmony export */   \"getTriggerPathFromTrace\": () => (/* binding */ getTriggerPathFromTrace)\n/* harmony export */ });\n/* harmony import */ var _common_string_starts_with__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/string/starts-with */ \"./src/common/string/starts-with.ts\");\n\nconst loadTrace = (hass, domain, item_id, run_id) => hass.callWS({\n  type: \"trace/get\",\n  domain,\n  item_id,\n  run_id\n});\nconst loadTraces = (hass, domain, item_id) => hass.callWS({\n  type: \"trace/list\",\n  domain,\n  item_id\n});\nconst loadTraceContexts = (hass, domain, item_id) => hass.callWS({\n  type: \"trace/contexts\",\n  domain,\n  item_id\n});\nconst getDataFromPath = (config, path) => {\n  const parts = path.split(\"/\").reverse();\n  let result = config;\n\n  while (parts.length) {\n    const raw = parts.pop();\n    const asNumber = Number(raw);\n\n    if (isNaN(asNumber)) {\n      const tempResult = result[raw];\n\n      if (!tempResult && raw === \"sequence\") {\n        continue;\n      }\n\n      result = tempResult;\n      continue;\n    }\n\n    if (Array.isArray(result)) {\n      result = result[asNumber];\n      continue;\n    }\n\n    if (asNumber !== 0) {\n      throw new Error(\"If config is not an array, can only return index 0\");\n    }\n  }\n\n  return result;\n}; // It is 'trigger' if manually triggered by the user via UI\n\nconst isTriggerPath = path => path === \"trigger\" || (0,_common_string_starts_with__WEBPACK_IMPORTED_MODULE_0__.strStartsWith)(path, \"trigger/\");\nconst getTriggerPathFromTrace = steps => Object.keys(steps).find(path => isTriggerPath(path));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS90cmFjZS50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFzSUE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFNQTtBQUNBO0FBQ0E7QUFIQTtBQVdBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUlBO0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUdBO0FBR0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ob21lLWFzc2lzdGFudC1mcm9udGVuZC8uL3NyYy9kYXRhL3RyYWNlLnRzP2U0ZTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3RyU3RhcnRzV2l0aCB9IGZyb20gXCIuLi9jb21tb24vc3RyaW5nL3N0YXJ0cy13aXRoXCI7XG5pbXBvcnQgeyBDb250ZXh0LCBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQge1xuICBCbHVlcHJpbnRBdXRvbWF0aW9uQ29uZmlnLFxuICBNYW51YWxBdXRvbWF0aW9uQ29uZmlnLFxufSBmcm9tIFwiLi9hdXRvbWF0aW9uXCI7XG5pbXBvcnQgeyBCbHVlcHJpbnRTY3JpcHRDb25maWcsIFNjcmlwdENvbmZpZyB9IGZyb20gXCIuL3NjcmlwdFwiO1xuXG5pbnRlcmZhY2UgQmFzZVRyYWNlU3RlcCB7XG4gIHBhdGg6IHN0cmluZztcbiAgdGltZXN0YW1wOiBzdHJpbmc7XG4gIGVycm9yPzogc3RyaW5nO1xuICBjaGFuZ2VkX3ZhcmlhYmxlcz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyaWdnZXJUcmFjZVN0ZXAgZXh0ZW5kcyBCYXNlVHJhY2VTdGVwIHtcbiAgY2hhbmdlZF92YXJpYWJsZXM6IHtcbiAgICB0cmlnZ2VyOiB7XG4gICAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgW2tleTogc3RyaW5nXTogdW5rbm93bjtcbiAgICB9O1xuICAgIFtrZXk6IHN0cmluZ106IHVua25vd247XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZGl0aW9uVHJhY2VTdGVwIGV4dGVuZHMgQmFzZVRyYWNlU3RlcCB7XG4gIHJlc3VsdD86IHsgcmVzdWx0OiBib29sZWFuIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FsbFNlcnZpY2VBY3Rpb25UcmFjZVN0ZXAgZXh0ZW5kcyBCYXNlVHJhY2VTdGVwIHtcbiAgcmVzdWx0Pzoge1xuICAgIGxpbWl0OiBudW1iZXI7XG4gICAgcnVubmluZ19zY3JpcHQ6IGJvb2xlYW47XG4gICAgcGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgfTtcbiAgY2hpbGRfaWQ/OiB7XG4gICAgZG9tYWluOiBzdHJpbmc7XG4gICAgaXRlbV9pZDogc3RyaW5nO1xuICAgIHJ1bl9pZDogc3RyaW5nO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENob29zZUFjdGlvblRyYWNlU3RlcCBleHRlbmRzIEJhc2VUcmFjZVN0ZXAge1xuICByZXN1bHQ/OiB7IGNob2ljZTogbnVtYmVyIHwgXCJkZWZhdWx0XCIgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJZkFjdGlvblRyYWNlU3RlcCBleHRlbmRzIEJhc2VUcmFjZVN0ZXAge1xuICByZXN1bHQ/OiB7IGNob2ljZTogXCJ0aGVuXCIgfCBcImVsc2VcIiB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0b3BBY3Rpb25UcmFjZVN0ZXAgZXh0ZW5kcyBCYXNlVHJhY2VTdGVwIHtcbiAgcmVzdWx0PzogeyBzdG9wOiBzdHJpbmc7IGVycm9yOiBib29sZWFuIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hvb3NlQ2hvaWNlQWN0aW9uVHJhY2VTdGVwIGV4dGVuZHMgQmFzZVRyYWNlU3RlcCB7XG4gIHJlc3VsdD86IHsgcmVzdWx0OiBib29sZWFuIH07XG59XG5cbmV4cG9ydCB0eXBlIEFjdGlvblRyYWNlU3RlcCA9XG4gIHwgQmFzZVRyYWNlU3RlcFxuICB8IENvbmRpdGlvblRyYWNlU3RlcFxuICB8IENhbGxTZXJ2aWNlQWN0aW9uVHJhY2VTdGVwXG4gIHwgQ2hvb3NlQWN0aW9uVHJhY2VTdGVwXG4gIHwgQ2hvb3NlQ2hvaWNlQWN0aW9uVHJhY2VTdGVwO1xuXG5pbnRlcmZhY2UgQmFzZVRyYWNlIHtcbiAgZG9tYWluOiBzdHJpbmc7XG4gIGl0ZW1faWQ6IHN0cmluZztcbiAgbGFzdF9zdGVwOiBzdHJpbmcgfCBudWxsO1xuICBydW5faWQ6IHN0cmluZztcbiAgc3RhdGU6IFwicnVubmluZ1wiIHwgXCJzdG9wcGVkXCIgfCBcImRlYnVnZ2VkXCI7XG4gIHRpbWVzdGFtcDoge1xuICAgIHN0YXJ0OiBzdHJpbmc7XG4gICAgZmluaXNoOiBzdHJpbmcgfCBudWxsO1xuICB9O1xuICBzY3JpcHRfZXhlY3V0aW9uOlxuICAgIHwgLy8gVGhlIHNjcmlwdCB3YXMgbm90IGV4ZWN1dGVkIGJlY2F1c2UgdGhlIGF1dG9tYXRpb24ncyBjb25kaXRpb24gZmFpbGVkXG4gICAgXCJmYWlsZWRfY29uZGl0aW9uc1wiXG4gICAgLy8gVGhlIHNjcmlwdCB3YXMgbm90IGV4ZWN1dGVkIGJlY2F1c2UgdGhlIHJ1biBtb2RlIGlzIHNpbmdsZVxuICAgIHwgXCJmYWlsZWRfc2luZ2xlXCJcbiAgICAvLyBUaGUgc2NyaXB0IHdhcyBub3QgZXhlY3V0ZWQgYmVjYXVzZSBtYXggcGFyYWxsZWwgcnVucyB3b3VsZCBiZSBleGNlZWRlZFxuICAgIHwgXCJmYWlsZWRfbWF4X3J1bnNcIlxuICAgIC8vIEFsbCBzY3JpcHQgc3RlcHMgZmluaXNoZWQ6XG4gICAgfCBcImZpbmlzaGVkXCJcbiAgICAvLyBTY3JpcHQgZXhlY3V0aW9uIHN0b3BwZWQgYnkgdGhlIHNjcmlwdCBpdHNlbGYgYmVjYXVzZSBhIGNvbmRpdGlvbiBmYWlscywgd2FpdF9mb3JfdHJpZ2dlciB0aW1lb3V0cyBldGM6XG4gICAgfCBcImFib3J0ZWRcIlxuICAgIC8vIERldGFpbHMgYWJvdXQgZmFpbGluZyBjb25kaXRpb24sIHRpbWVvdXQgZXRjLiBpcyBpbiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSB0cmFjZVxuICAgIC8vIFNjcmlwdCBleGVjdXRpb24gc3RvcHMgYmVjYXVzZSBvZiBhbiB1bmV4cGVjdGVkIGV4Y2VwdGlvbjpcbiAgICB8IFwiZXJyb3JcIlxuICAgIC8vIFRoZSBleGNlcHRpb24gaXMgaW4gdGhlIHRyYWNlIGl0c2VsZiBvciBpbiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSB0cmFjZVxuICAgIC8vIFNjcmlwdCBleGVjdXRpb24gc3RvcHBlZCBieSBhc3luY19zdG9wIGNhbGxlZCBvbiB0aGUgc2NyaXB0IHJ1biBiZWNhdXNlIGhvbWUgYXNzaXN0YW50IGlzIHNodXR0aW5nIGRvd24sIHNjcmlwdCBtb2RlIGlzIFNDUklQVF9NT0RFX1JFU1RBUlQgZXRjOlxuICAgIHwgXCJjYW5jZWxsZWRcIjtcbn1cblxuaW50ZXJmYWNlIEJhc2VUcmFjZUV4dGVuZGVkIHtcbiAgdHJhY2U6IFJlY29yZDxzdHJpbmcsIEFjdGlvblRyYWNlU3RlcFtdPjtcbiAgY29udGV4dDogQ29udGV4dDtcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXV0b21hdGlvblRyYWNlIGV4dGVuZHMgQmFzZVRyYWNlIHtcbiAgZG9tYWluOiBcImF1dG9tYXRpb25cIjtcbiAgdHJpZ2dlcjogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEF1dG9tYXRpb25UcmFjZUV4dGVuZGVkXG4gIGV4dGVuZHMgQXV0b21hdGlvblRyYWNlLFxuICAgIEJhc2VUcmFjZUV4dGVuZGVkIHtcbiAgY29uZmlnOiBNYW51YWxBdXRvbWF0aW9uQ29uZmlnO1xuICBibHVlcHJpbnRfaW5wdXRzPzogQmx1ZXByaW50QXV0b21hdGlvbkNvbmZpZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTY3JpcHRUcmFjZSBleHRlbmRzIEJhc2VUcmFjZSB7XG4gIGRvbWFpbjogXCJzY3JpcHRcIjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTY3JpcHRUcmFjZUV4dGVuZGVkIGV4dGVuZHMgU2NyaXB0VHJhY2UsIEJhc2VUcmFjZUV4dGVuZGVkIHtcbiAgY29uZmlnOiBTY3JpcHRDb25maWc7XG4gIGJsdWVwcmludF9pbnB1dHM/OiBCbHVlcHJpbnRTY3JpcHRDb25maWc7XG59XG5cbmV4cG9ydCB0eXBlIFRyYWNlRXh0ZW5kZWQgPSBBdXRvbWF0aW9uVHJhY2VFeHRlbmRlZCB8IFNjcmlwdFRyYWNlRXh0ZW5kZWQ7XG5cbmludGVyZmFjZSBUcmFjZVR5cGVzIHtcbiAgYXV0b21hdGlvbjoge1xuICAgIHNob3J0OiBBdXRvbWF0aW9uVHJhY2U7XG4gICAgZXh0ZW5kZWQ6IEF1dG9tYXRpb25UcmFjZUV4dGVuZGVkO1xuICB9O1xuICBzY3JpcHQ6IHtcbiAgICBzaG9ydDogU2NyaXB0VHJhY2U7XG4gICAgZXh0ZW5kZWQ6IFNjcmlwdFRyYWNlRXh0ZW5kZWQ7XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBsb2FkVHJhY2UgPSA8VCBleHRlbmRzIGtleW9mIFRyYWNlVHlwZXM+KFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBkb21haW46IFQsXG4gIGl0ZW1faWQ6IHN0cmluZyxcbiAgcnVuX2lkOiBzdHJpbmdcbik6IFByb21pc2U8VHJhY2VUeXBlc1tUXVtcImV4dGVuZGVkXCJdPiA9PlxuICBoYXNzLmNhbGxXUyh7XG4gICAgdHlwZTogXCJ0cmFjZS9nZXRcIixcbiAgICBkb21haW4sXG4gICAgaXRlbV9pZCxcbiAgICBydW5faWQsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgbG9hZFRyYWNlcyA9IDxUIGV4dGVuZHMga2V5b2YgVHJhY2VUeXBlcz4oXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGRvbWFpbjogVCxcbiAgaXRlbV9pZDogc3RyaW5nXG4pOiBQcm9taXNlPEFycmF5PFRyYWNlVHlwZXNbVF1bXCJzaG9ydFwiXT4+ID0+XG4gIGhhc3MuY2FsbFdTKHtcbiAgICB0eXBlOiBcInRyYWNlL2xpc3RcIixcbiAgICBkb21haW4sXG4gICAgaXRlbV9pZCxcbiAgfSk7XG5cbmV4cG9ydCB0eXBlIFRyYWNlQ29udGV4dHMgPSBSZWNvcmQ8XG4gIHN0cmluZyxcbiAgeyBydW5faWQ6IHN0cmluZzsgZG9tYWluOiBzdHJpbmc7IGl0ZW1faWQ6IHN0cmluZyB9XG4+O1xuXG5leHBvcnQgY29uc3QgbG9hZFRyYWNlQ29udGV4dHMgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGRvbWFpbj86IHN0cmluZyxcbiAgaXRlbV9pZD86IHN0cmluZ1xuKTogUHJvbWlzZTxUcmFjZUNvbnRleHRzPiA9PlxuICBoYXNzLmNhbGxXUyh7XG4gICAgdHlwZTogXCJ0cmFjZS9jb250ZXh0c1wiLFxuICAgIGRvbWFpbixcbiAgICBpdGVtX2lkLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGdldERhdGFGcm9tUGF0aCA9IChcbiAgY29uZmlnOiBUcmFjZUV4dGVuZGVkW1wiY29uZmlnXCJdLFxuICBwYXRoOiBzdHJpbmdcbik6IGFueSA9PiB7XG4gIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdChcIi9cIikucmV2ZXJzZSgpO1xuXG4gIGxldCByZXN1bHQ6IGFueSA9IGNvbmZpZztcblxuICB3aGlsZSAocGFydHMubGVuZ3RoKSB7XG4gICAgY29uc3QgcmF3ID0gcGFydHMucG9wKCkhO1xuICAgIGNvbnN0IGFzTnVtYmVyID0gTnVtYmVyKHJhdyk7XG5cbiAgICBpZiAoaXNOYU4oYXNOdW1iZXIpKSB7XG4gICAgICBjb25zdCB0ZW1wUmVzdWx0ID0gcmVzdWx0W3Jhd107XG4gICAgICBpZiAoIXRlbXBSZXN1bHQgJiYgcmF3ID09PSBcInNlcXVlbmNlXCIpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICByZXN1bHQgPSB0ZW1wUmVzdWx0O1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkocmVzdWx0KSkge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0W2FzTnVtYmVyXTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChhc051bWJlciAhPT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSWYgY29uZmlnIGlzIG5vdCBhbiBhcnJheSwgY2FuIG9ubHkgcmV0dXJuIGluZGV4IDBcIik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIEl0IGlzICd0cmlnZ2VyJyBpZiBtYW51YWxseSB0cmlnZ2VyZWQgYnkgdGhlIHVzZXIgdmlhIFVJXG5leHBvcnQgY29uc3QgaXNUcmlnZ2VyUGF0aCA9IChwYXRoOiBzdHJpbmcpOiBib29sZWFuID0+XG4gIHBhdGggPT09IFwidHJpZ2dlclwiIHx8IHN0clN0YXJ0c1dpdGgocGF0aCwgXCJ0cmlnZ2VyL1wiKTtcblxuZXhwb3J0IGNvbnN0IGdldFRyaWdnZXJQYXRoRnJvbVRyYWNlID0gKFxuICBzdGVwczogUmVjb3JkPHN0cmluZywgQmFzZVRyYWNlU3RlcFtdPlxuKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IE9iamVjdC5rZXlzKHN0ZXBzKS5maW5kKChwYXRoKSA9PiBpc1RyaWdnZXJQYXRoKHBhdGgpKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/data/trace.ts\n");

/***/ }),

/***/ "./src/panels/logbook/ha-logbook-renderer.ts":
/*!***************************************************!*\
  !*** ./src/panels/logbook/ha-logbook-renderer.ts ***!
  \***************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__) => {\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _lit_labs_virtualizer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @lit-labs/virtualizer */ \"./node_modules/@lit-labs/virtualizer/lit-virtualizer.js\");\n/* harmony import */ var lit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit */ \"./node_modules/lit/index.js\");\n/* harmony import */ var lit_decorators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit/decorators */ \"./node_modules/lit/decorators.js\");\n/* harmony import */ var lit_directives_class_map__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lit/directives/class-map */ \"./node_modules/lit/directives/class-map.js\");\n/* harmony import */ var _common_datetime_format_date__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/datetime/format_date */ \"./src/common/datetime/format_date.ts\");\n/* harmony import */ var _common_datetime_format_time__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/datetime/format_time */ \"./src/common/datetime/format_time.ts\");\n/* harmony import */ var _common_decorators_restore_scroll__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/decorators/restore-scroll */ \"./src/common/decorators/restore-scroll.ts\");\n/* harmony import */ var _common_dom_fire_event__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common/dom/fire_event */ \"./src/common/dom/fire_event.ts\");\n/* harmony import */ var _common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/entity/compute_domain */ \"./src/common/entity/compute_domain.ts\");\n/* harmony import */ var _common_config_is_component_loaded__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common/config/is_component_loaded */ \"./src/common/config/is_component_loaded.ts\");\n/* harmony import */ var _components_entity_state_badge__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/entity/state-badge */ \"./src/components/entity/state-badge.ts\");\n/* harmony import */ var _components_ha_circular_progress__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../components/ha-circular-progress */ \"./src/components/ha-circular-progress.ts\");\n/* harmony import */ var _components_ha_relative_time__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../components/ha-relative-time */ \"./src/components/ha-relative-time.ts\");\n/* harmony import */ var _data_logbook__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../data/logbook */ \"./src/data/logbook.ts\");\n/* harmony import */ var _resources_styles__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../resources/styles */ \"./src/resources/styles.ts\");\n/* harmony import */ var _util_brands_url__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../util/brands-url */ \"./src/util/brands-url.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_data_logbook__WEBPACK_IMPORTED_MODULE_13__, _common_datetime_format_time__WEBPACK_IMPORTED_MODULE_5__, _common_datetime_format_date__WEBPACK_IMPORTED_MODULE_4__, _components_ha_relative_time__WEBPACK_IMPORTED_MODULE_12__]);\n([_data_logbook__WEBPACK_IMPORTED_MODULE_13__, _common_datetime_format_time__WEBPACK_IMPORTED_MODULE_5__, _common_datetime_format_date__WEBPACK_IMPORTED_MODULE_4__, _components_ha_relative_time__WEBPACK_IMPORTED_MODULE_12__] = __webpack_async_dependencies__.then ? await __webpack_async_dependencies__ : __webpack_async_dependencies__);\nfunction _decorate(decorators, factory, superClass, mixins) { var api = _getDecoratorsApi(); if (mixins) { for (var i = 0; i < mixins.length; i++) { api = mixins[i](api); } } var r = factory(function initialize(O) { api.initializeInstanceElements(O, decorated.elements); }, superClass); var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators); api.initializeClassElements(r.F, decorated.elements); return api.runClassFinishers(r.F, decorated.finishers); }\n\nfunction _getDecoratorsApi() { _getDecoratorsApi = function () { return api; }; var api = { elementsDefinitionOrder: [[\"method\"], [\"field\"]], initializeInstanceElements: function (O, elements) { [\"method\", \"field\"].forEach(function (kind) { elements.forEach(function (element) { if (element.kind === kind && element.placement === \"own\") { this.defineClassElement(O, element); } }, this); }, this); }, initializeClassElements: function (F, elements) { var proto = F.prototype; [\"method\", \"field\"].forEach(function (kind) { elements.forEach(function (element) { var placement = element.placement; if (element.kind === kind && (placement === \"static\" || placement === \"prototype\")) { var receiver = placement === \"static\" ? F : proto; this.defineClassElement(receiver, element); } }, this); }, this); }, defineClassElement: function (receiver, element) { var descriptor = element.descriptor; if (element.kind === \"field\") { var initializer = element.initializer; descriptor = { enumerable: descriptor.enumerable, writable: descriptor.writable, configurable: descriptor.configurable, value: initializer === void 0 ? void 0 : initializer.call(receiver) }; } Object.defineProperty(receiver, element.key, descriptor); }, decorateClass: function (elements, decorators) { var newElements = []; var finishers = []; var placements = { static: [], prototype: [], own: [] }; elements.forEach(function (element) { this.addElementPlacement(element, placements); }, this); elements.forEach(function (element) { if (!_hasDecorators(element)) return newElements.push(element); var elementFinishersExtras = this.decorateElement(element, placements); newElements.push(elementFinishersExtras.element); newElements.push.apply(newElements, elementFinishersExtras.extras); finishers.push.apply(finishers, elementFinishersExtras.finishers); }, this); if (!decorators) { return { elements: newElements, finishers: finishers }; } var result = this.decorateConstructor(newElements, decorators); finishers.push.apply(finishers, result.finishers); result.finishers = finishers; return result; }, addElementPlacement: function (element, placements, silent) { var keys = placements[element.placement]; if (!silent && keys.indexOf(element.key) !== -1) { throw new TypeError(\"Duplicated element (\" + element.key + \")\"); } keys.push(element.key); }, decorateElement: function (element, placements) { var extras = []; var finishers = []; for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) { var keys = placements[element.placement]; keys.splice(keys.indexOf(element.key), 1); var elementObject = this.fromElementDescriptor(element); var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject); element = elementFinisherExtras.element; this.addElementPlacement(element, placements); if (elementFinisherExtras.finisher) { finishers.push(elementFinisherExtras.finisher); } var newExtras = elementFinisherExtras.extras; if (newExtras) { for (var j = 0; j < newExtras.length; j++) { this.addElementPlacement(newExtras[j], placements); } extras.push.apply(extras, newExtras); } } return { element: element, finishers: finishers, extras: extras }; }, decorateConstructor: function (elements, decorators) { var finishers = []; for (var i = decorators.length - 1; i >= 0; i--) { var obj = this.fromClassDescriptor(elements); var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj); if (elementsAndFinisher.finisher !== undefined) { finishers.push(elementsAndFinisher.finisher); } if (elementsAndFinisher.elements !== undefined) { elements = elementsAndFinisher.elements; for (var j = 0; j < elements.length - 1; j++) { for (var k = j + 1; k < elements.length; k++) { if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) { throw new TypeError(\"Duplicated element (\" + elements[j].key + \")\"); } } } } } return { elements: elements, finishers: finishers }; }, fromElementDescriptor: function (element) { var obj = { kind: element.kind, key: element.key, placement: element.placement, descriptor: element.descriptor }; var desc = { value: \"Descriptor\", configurable: true }; Object.defineProperty(obj, Symbol.toStringTag, desc); if (element.kind === \"field\") obj.initializer = element.initializer; return obj; }, toElementDescriptors: function (elementObjects) { if (elementObjects === undefined) return; return _toArray(elementObjects).map(function (elementObject) { var element = this.toElementDescriptor(elementObject); this.disallowProperty(elementObject, \"finisher\", \"An element descriptor\"); this.disallowProperty(elementObject, \"extras\", \"An element descriptor\"); return element; }, this); }, toElementDescriptor: function (elementObject) { var kind = String(elementObject.kind); if (kind !== \"method\" && kind !== \"field\") { throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"'); } var key = _toPropertyKey(elementObject.key); var placement = String(elementObject.placement); if (placement !== \"static\" && placement !== \"prototype\" && placement !== \"own\") { throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"'); } var descriptor = elementObject.descriptor; this.disallowProperty(elementObject, \"elements\", \"An element descriptor\"); var element = { kind: kind, key: key, placement: placement, descriptor: Object.assign({}, descriptor) }; if (kind !== \"field\") { this.disallowProperty(elementObject, \"initializer\", \"A method descriptor\"); } else { this.disallowProperty(descriptor, \"get\", \"The property descriptor of a field descriptor\"); this.disallowProperty(descriptor, \"set\", \"The property descriptor of a field descriptor\"); this.disallowProperty(descriptor, \"value\", \"The property descriptor of a field descriptor\"); element.initializer = elementObject.initializer; } return element; }, toElementFinisherExtras: function (elementObject) { var element = this.toElementDescriptor(elementObject); var finisher = _optionalCallableProperty(elementObject, \"finisher\"); var extras = this.toElementDescriptors(elementObject.extras); return { element: element, finisher: finisher, extras: extras }; }, fromClassDescriptor: function (elements) { var obj = { kind: \"class\", elements: elements.map(this.fromElementDescriptor, this) }; var desc = { value: \"Descriptor\", configurable: true }; Object.defineProperty(obj, Symbol.toStringTag, desc); return obj; }, toClassDescriptor: function (obj) { var kind = String(obj.kind); if (kind !== \"class\") { throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"'); } this.disallowProperty(obj, \"key\", \"A class descriptor\"); this.disallowProperty(obj, \"placement\", \"A class descriptor\"); this.disallowProperty(obj, \"descriptor\", \"A class descriptor\"); this.disallowProperty(obj, \"initializer\", \"A class descriptor\"); this.disallowProperty(obj, \"extras\", \"A class descriptor\"); var finisher = _optionalCallableProperty(obj, \"finisher\"); var elements = this.toElementDescriptors(obj.elements); return { elements: elements, finisher: finisher }; }, runClassFinishers: function (constructor, finishers) { for (var i = 0; i < finishers.length; i++) { var newConstructor = (0, finishers[i])(constructor); if (newConstructor !== undefined) { if (typeof newConstructor !== \"function\") { throw new TypeError(\"Finishers must return a constructor.\"); } constructor = newConstructor; } } return constructor; }, disallowProperty: function (obj, name, objectType) { if (obj[name] !== undefined) { throw new TypeError(objectType + \" can't have a .\" + name + \" property.\"); } } }; return api; }\n\nfunction _createElementDescriptor(def) { var key = _toPropertyKey(def.key); var descriptor; if (def.kind === \"method\") { descriptor = { value: def.value, writable: true, configurable: true, enumerable: false }; } else if (def.kind === \"get\") { descriptor = { get: def.value, configurable: true, enumerable: false }; } else if (def.kind === \"set\") { descriptor = { set: def.value, configurable: true, enumerable: false }; } else if (def.kind === \"field\") { descriptor = { configurable: true, writable: true, enumerable: true }; } var element = { kind: def.kind === \"field\" ? \"field\" : \"method\", key: key, placement: def.static ? \"static\" : def.kind === \"field\" ? \"own\" : \"prototype\", descriptor: descriptor }; if (def.decorators) element.decorators = def.decorators; if (def.kind === \"field\") element.initializer = def.value; return element; }\n\nfunction _coalesceGetterSetter(element, other) { if (element.descriptor.get !== undefined) { other.descriptor.get = element.descriptor.get; } else { other.descriptor.set = element.descriptor.set; } }\n\nfunction _coalesceClassElements(elements) { var newElements = []; var isSameElement = function (other) { return other.kind === \"method\" && other.key === element.key && other.placement === element.placement; }; for (var i = 0; i < elements.length; i++) { var element = elements[i]; var other; if (element.kind === \"method\" && (other = newElements.find(isSameElement))) { if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) { if (_hasDecorators(element) || _hasDecorators(other)) { throw new ReferenceError(\"Duplicated methods (\" + element.key + \") can't be decorated.\"); } other.descriptor = element.descriptor; } else { if (_hasDecorators(element)) { if (_hasDecorators(other)) { throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + \"the same property (\" + element.key + \").\"); } other.decorators = element.decorators; } _coalesceGetterSetter(element, other); } } else { newElements.push(element); } } return newElements; }\n\nfunction _hasDecorators(element) { return element.decorators && element.decorators.length; }\n\nfunction _isDataDescriptor(desc) { return desc !== undefined && !(desc.value === undefined && desc.writable === undefined); }\n\nfunction _optionalCallableProperty(obj, name) { var value = obj[name]; if (value !== undefined && typeof value !== \"function\") { throw new TypeError(\"Expected '\" + name + \"' to be a function\"); } return value; }\n\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\n\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nfunction _toArray(arr) { return _arrayWithHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst triggerDomains = [\"script\", \"automation\"];\n\nconst hasContext = item => item.context_event_type || item.context_state || item.context_message;\n\nconst stripEntityId = (message, entityId) => entityId ? message.replace(entityId, \" \") : message;\n\nlet HaLogbookRenderer = _decorate([(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.customElement)(\"ha-logbook-renderer\")], function (_initialize, _LitElement) {\n  class HaLogbookRenderer extends _LitElement {\n    constructor(...args) {\n      super(...args);\n\n      _initialize(this);\n    }\n\n  }\n\n  return {\n    F: HaLogbookRenderer,\n    d: [{\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"hass\",\n      value: void 0\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"userIdToName\",\n\n      value() {\n        return {};\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"traceContexts\",\n\n      value() {\n        return {};\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        attribute: false\n      })],\n      key: \"entries\",\n\n      value() {\n        return [];\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"narrow\"\n      })],\n      key: \"narrow\",\n\n      value() {\n        return false;\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"virtualize\",\n        reflect: true\n      })],\n      key: \"virtualize\",\n\n      value() {\n        return false;\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"no-icon\"\n      })],\n      key: \"noIcon\",\n\n      value() {\n        return false;\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"no-name\"\n      })],\n      key: \"noName\",\n\n      value() {\n        return false;\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.property)({\n        type: Boolean,\n        attribute: \"relative-time\"\n      })],\n      key: \"relativeTime\",\n\n      value() {\n        return false;\n      }\n\n    }, {\n      kind: \"field\",\n      decorators: [(0,_common_decorators_restore_scroll__WEBPACK_IMPORTED_MODULE_6__.restoreScroll)(\".container\")],\n      key: \"_savedScrollPos\",\n      value: void 0\n    }, {\n      kind: \"method\",\n      key: \"shouldUpdate\",\n      value: // @ts-ignore\n      function shouldUpdate(changedProps) {\n        const oldHass = changedProps.get(\"hass\");\n        const languageChanged = oldHass === undefined || oldHass.locale !== this.hass.locale;\n        return changedProps.has(\"entries\") || changedProps.has(\"traceContexts\") || languageChanged;\n      }\n    }, {\n      kind: \"method\",\n      key: \"render\",\n      value: function render() {\n        var _this$entries;\n\n        if (!((_this$entries = this.entries) !== null && _this$entries !== void 0 && _this$entries.length)) {\n          return lit__WEBPACK_IMPORTED_MODULE_1__.html`\n        <div class=\"container no-entries\">\n          ${this.hass.localize(\"ui.components.logbook.entries_not_found\")}\n        </div>\n      `;\n        }\n\n        return lit__WEBPACK_IMPORTED_MODULE_1__.html`\n      <div\n        class=\"container ha-scrollbar ${(0,lit_directives_class_map__WEBPACK_IMPORTED_MODULE_3__.classMap)({\n          narrow: this.narrow,\n          \"no-name\": this.noName,\n          \"no-icon\": this.noIcon\n        })}\"\n        @scroll=${this._saveScrollPos}\n      >\n        ${this.virtualize ? lit__WEBPACK_IMPORTED_MODULE_1__.html`<lit-virtualizer\n              @visibilityChanged=${this._visibilityChanged}\n              scroller\n              class=\"ha-scrollbar\"\n              .items=${this.entries}\n              .renderItem=${this._renderLogbookItem}\n            >\n            </lit-virtualizer>` : this.entries.map((item, index) => this._renderLogbookItem(item, index))}\n      </div>\n    `;\n      }\n    }, {\n      kind: \"field\",\n      key: \"_renderLogbookItem\",\n\n      value() {\n        return (item, index) => {\n          var _this$hass$themes;\n\n          if (!item || index === undefined) {\n            return lit__WEBPACK_IMPORTED_MODULE_1__.html``;\n          }\n\n          const previous = this.entries[index - 1];\n          const seenEntityIds = [];\n          const currentStateObj = item.entity_id ? this.hass.states[item.entity_id] : undefined;\n          const historicStateObj = currentStateObj ? (0,_data_logbook__WEBPACK_IMPORTED_MODULE_13__.createHistoricState)(currentStateObj, item.state) : undefined;\n          const domain = item.entity_id ? (0,_common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_8__.computeDomain)(item.entity_id) : // Domain is there if there is no entity ID.\n          item.domain;\n          const overrideImage = !historicStateObj && !item.icon && !item.state && domain && (0,_common_config_is_component_loaded__WEBPACK_IMPORTED_MODULE_9__.isComponentLoaded)(this.hass, domain) ? (0,_util_brands_url__WEBPACK_IMPORTED_MODULE_15__.brandsUrl)({\n            domain: domain,\n            type: \"icon\",\n            useFallback: true,\n            darkOptimized: (_this$hass$themes = this.hass.themes) === null || _this$hass$themes === void 0 ? void 0 : _this$hass$themes.darkMode\n          }) : undefined;\n          return lit__WEBPACK_IMPORTED_MODULE_1__.html`\n      <div class=\"entry-container\">\n        ${index === 0 || item !== null && item !== void 0 && item.when && previous !== null && previous !== void 0 && previous.when && new Date(item.when * 1000).toDateString() !== new Date(previous.when * 1000).toDateString() ? lit__WEBPACK_IMPORTED_MODULE_1__.html`\n              <h4 class=\"date\">\n                ${(0,_common_datetime_format_date__WEBPACK_IMPORTED_MODULE_4__.formatDate)(new Date(item.when * 1000), this.hass.locale)}\n              </h4>\n            ` : lit__WEBPACK_IMPORTED_MODULE_1__.html``}\n\n        <div class=\"entry ${(0,lit_directives_class_map__WEBPACK_IMPORTED_MODULE_3__.classMap)({\n            \"no-entity\": !item.entity_id\n          })}\">\n          <div class=\"icon-message\">\n            ${!this.noIcon ? lit__WEBPACK_IMPORTED_MODULE_1__.html`\n                  <state-badge\n                    .hass=${this.hass}\n                    .overrideIcon=${item.icon}\n                    .overrideImage=${overrideImage}\n                    .stateObj=${item.icon ? undefined : historicStateObj}\n                    .stateColor=${false}\n                  ></state-badge>\n                ` : \"\"}\n            <div class=\"message-relative_time\">\n              <div class=\"message\">\n                ${!this.noName // Used for more-info panel (single entity case)\n          ? this._renderEntity(item.entity_id, item.name) : \"\"}\n                ${this._renderMessage(item, seenEntityIds, domain, historicStateObj)}\n                ${this._renderContextMessage(item, seenEntityIds)}\n              </div>\n              <div class=\"secondary\">\n                <span\n                  >${(0,_common_datetime_format_time__WEBPACK_IMPORTED_MODULE_5__.formatTimeWithSeconds)(new Date(item.when * 1000), this.hass.locale)}</span\n                >\n                -\n                <ha-relative-time\n                  .hass=${this.hass}\n                  .datetime=${item.when * 1000}\n                  capitalize\n                ></ha-relative-time>\n                ${item.context_user_id ? lit__WEBPACK_IMPORTED_MODULE_1__.html`${this._renderUser(item)}` : \"\"}\n                ${triggerDomains.includes(item.domain) && item.context_id in this.traceContexts ? lit__WEBPACK_IMPORTED_MODULE_1__.html`\n                      -\n                      <a\n                        href=${`/config/${this.traceContexts[item.context_id].domain}/trace/${this.traceContexts[item.context_id].domain === \"script\" ? `script.${this.traceContexts[item.context_id].item_id}` : this.traceContexts[item.context_id].item_id}?run_id=${this.traceContexts[item.context_id].run_id}`}\n                        @click=${this._close}\n                        >${this.hass.localize(\"ui.components.logbook.show_trace\")}</a\n                      >\n                    ` : \"\"}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n        };\n      }\n\n    }, {\n      kind: \"method\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.eventOptions)({\n        passive: true\n      })],\n      key: \"_saveScrollPos\",\n      value: function _saveScrollPos(e) {\n        this._savedScrollPos = e.target.scrollTop;\n      }\n    }, {\n      kind: \"method\",\n      decorators: [(0,lit_decorators__WEBPACK_IMPORTED_MODULE_2__.eventOptions)({\n        passive: true\n      })],\n      key: \"_visibilityChanged\",\n      value: function _visibilityChanged(e) {\n        (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_7__.fireEvent)(this, \"hass-logbook-live\", {\n          enable: e.first === 0\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderMessage\",\n      value: function _renderMessage(item, seenEntityIds, domain, historicStateObj) {\n        if (item.entity_id) {\n          if (item.state) {\n            return historicStateObj ? (0,_data_logbook__WEBPACK_IMPORTED_MODULE_13__.localizeStateMessage)(this.hass, this.hass.localize, item.state, historicStateObj, domain) : item.state;\n          }\n        }\n\n        const itemHasContext = hasContext(item);\n        let message = item.message;\n\n        if (triggerDomains.includes(domain) && item.source) {\n          if (itemHasContext) {\n            // These domains include the trigger source in the message\n            // but if we have the context we want to display that instead\n            // as otherwise we display duplicate triggers\n            return \"\";\n          }\n\n          message = (0,_data_logbook__WEBPACK_IMPORTED_MODULE_13__.localizeTriggerSource)(this.hass.localize, item.source);\n        }\n\n        return message ? this._formatMessageWithPossibleEntity(itemHasContext ? stripEntityId(message, item.context_entity_id) : message, seenEntityIds, undefined) : \"\";\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderUser\",\n      value: function _renderUser(item) {\n        const item_username = item.context_user_id && this.userIdToName[item.context_user_id];\n\n        if (item_username) {\n          return `- ${item_username}`;\n        }\n\n        return \"\";\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderUnseenContextSourceEntity\",\n      value: function _renderUnseenContextSourceEntity(item, seenEntityIds) {\n        if (!item.context_entity_id || seenEntityIds.includes(item.context_entity_id)) {\n          return \"\";\n        } // We don't know what caused this entity\n        // to be included since its an integration\n        // described event.\n\n\n        return lit__WEBPACK_IMPORTED_MODULE_1__.html` (${this._renderEntity(item.context_entity_id, item.context_entity_id_name)})`;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderContextMessage\",\n      value: function _renderContextMessage(item, seenEntityIds) {\n        // State change\n        if (item.context_state) {\n          const historicStateObj = item.context_entity_id && item.context_entity_id in this.hass.states ? (0,_data_logbook__WEBPACK_IMPORTED_MODULE_13__.createHistoricState)(this.hass.states[item.context_entity_id], item.context_state) : undefined;\n          return lit__WEBPACK_IMPORTED_MODULE_1__.html`${this.hass.localize(\"ui.components.logbook.triggered_by_state_of\")}\n      ${this._renderEntity(item.context_entity_id, item.context_entity_id_name)}\n      ${historicStateObj ? (0,_data_logbook__WEBPACK_IMPORTED_MODULE_13__.localizeStateMessage)(this.hass, this.hass.localize, item.context_state, historicStateObj, (0,_common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_8__.computeDomain)(item.context_entity_id)) : item.context_state}`;\n        } // Service call\n\n\n        if (item.context_event_type === \"call_service\") {\n          return lit__WEBPACK_IMPORTED_MODULE_1__.html`${this.hass.localize(\"ui.components.logbook.triggered_by_service\")}\n      ${item.context_domain}.${item.context_service}`;\n        }\n\n        if (!item.context_message || seenEntityIds.includes(item.context_entity_id)) {\n          return \"\";\n        } // Automation or script\n\n\n        if (item.context_event_type === \"automation_triggered\" || item.context_event_type === \"script_started\") {\n          // context_source is available in 2022.6 and later\n          const triggerMsg = item.context_source ? item.context_source : item.context_message.replace(\"triggered by \", \"\");\n          const contextTriggerSource = (0,_data_logbook__WEBPACK_IMPORTED_MODULE_13__.localizeTriggerSource)(this.hass.localize, triggerMsg);\n          return lit__WEBPACK_IMPORTED_MODULE_1__.html`${this.hass.localize(item.context_event_type === \"automation_triggered\" ? \"ui.components.logbook.triggered_by_automation\" : \"ui.components.logbook.triggered_by_script\")}\n      ${this._renderEntity(item.context_entity_id, item.context_entity_id_name)}\n      ${item.context_message ? this._formatMessageWithPossibleEntity(contextTriggerSource, seenEntityIds) : \"\"}`;\n        } // Generic externally described logbook platform\n        // These are not localizable\n\n\n        return lit__WEBPACK_IMPORTED_MODULE_1__.html` ${this.hass.localize(\"ui.components.logbook.triggered_by\")}\n    ${item.context_name}\n    ${this._formatMessageWithPossibleEntity(item.context_message, seenEntityIds, item.context_entity_id)}\n    ${this._renderUnseenContextSourceEntity(item, seenEntityIds)}`;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_renderEntity\",\n      value: function _renderEntity(entityId, entityName) {\n        const hasState = entityId && entityId in this.hass.states;\n        const displayName = entityName || (hasState ? this.hass.states[entityId].attributes.friendly_name || entityId : entityId);\n\n        if (!hasState) {\n          return displayName;\n        }\n\n        return lit__WEBPACK_IMPORTED_MODULE_1__.html`<button\n      class=\"link\"\n      @click=${this._entityClicked}\n      .entityId=${entityId}\n    >\n      ${displayName}\n    </button>`;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_formatMessageWithPossibleEntity\",\n      value: function _formatMessageWithPossibleEntity(message, seenEntities, possibleEntity) {\n        //\n        // As we are looking at a log(book), we are doing entity_id\n        // \"highlighting\"/\"colorizing\". The goal is to make it easy for\n        // the user to access the entity that caused the event.\n        //\n        // If there is an entity_id in the message that is also in the\n        // state machine, we search the message for the entity_id and\n        // replace it with _renderEntity\n        //\n        if (message.indexOf(\".\") !== -1) {\n          const messageParts = message.split(\" \");\n\n          for (let i = 0, size = messageParts.length; i < size; i++) {\n            if (messageParts[i] in this.hass.states) {\n              const entityId = messageParts[i];\n\n              if (seenEntities.includes(entityId)) {\n                return \"\";\n              }\n\n              seenEntities.push(entityId);\n              const messageEnd = messageParts.splice(i);\n              messageEnd.shift(); // remove the entity\n\n              return lit__WEBPACK_IMPORTED_MODULE_1__.html`${messageParts.join(\" \")}\n          ${this._renderEntity(entityId, this.hass.states[entityId].attributes.friendly_name)}\n          ${messageEnd.join(\" \")}`;\n            }\n          }\n        } //\n        // When we have a message has a specific entity_id attached to\n        // it, and the entity_id is not in the message, we look\n        // for the friendly name of the entity and replace that with\n        // _renderEntity if its there so the user can quickly get to\n        // that entity.\n        //\n\n\n        if (possibleEntity && possibleEntity in this.hass.states) {\n          const possibleEntityName = this.hass.states[possibleEntity].attributes.friendly_name;\n\n          if (possibleEntityName && message.endsWith(possibleEntityName)) {\n            if (seenEntities.includes(possibleEntity)) {\n              return \"\";\n            }\n\n            seenEntities.push(possibleEntity);\n            message = message.substring(0, message.length - possibleEntityName.length);\n            return lit__WEBPACK_IMPORTED_MODULE_1__.html`${message}\n        ${this._renderEntity(possibleEntity, possibleEntityName)}`;\n          }\n        }\n\n        return message;\n      }\n    }, {\n      kind: \"method\",\n      key: \"_entityClicked\",\n      value: function _entityClicked(ev) {\n        const entityId = ev.currentTarget.entityId;\n\n        if (!entityId) {\n          return;\n        }\n\n        ev.preventDefault();\n        ev.stopPropagation();\n        (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_7__.fireEvent)(this, \"hass-more-info\", {\n          entityId: entityId\n        });\n      }\n    }, {\n      kind: \"method\",\n      key: \"_close\",\n      value: function _close() {\n        setTimeout(() => (0,_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_7__.fireEvent)(this, \"closed\"), 500);\n      }\n    }, {\n      kind: \"get\",\n      static: true,\n      key: \"styles\",\n      value: function styles() {\n        return [_resources_styles__WEBPACK_IMPORTED_MODULE_14__.haStyle, _resources_styles__WEBPACK_IMPORTED_MODULE_14__.haStyleScrollbar, _resources_styles__WEBPACK_IMPORTED_MODULE_14__.buttonLinkStyle, lit__WEBPACK_IMPORTED_MODULE_1__.css`\n        :host([virtualize]) {\n          display: block;\n          height: 100%;\n        }\n\n        .entry-container {\n          width: 100%;\n        }\n\n        .entry {\n          display: flex;\n          width: 100%;\n          line-height: 2em;\n          padding: 8px 16px;\n          box-sizing: border-box;\n          border-top: 1px solid var(--divider-color);\n        }\n\n        .entry.no-entity,\n        .no-name .entry {\n          cursor: default;\n        }\n\n        .entry:hover {\n          background-color: rgba(var(--rgb-primary-text-color), 0.04);\n        }\n\n        .narrow:not(.no-icon) .time {\n          margin-left: 32px;\n          margin-inline-start: 32px;\n          margin-inline-end: initial;\n          direction: var(--direction);\n        }\n\n        .message-relative_time {\n          display: flex;\n          flex-direction: column;\n        }\n\n        .secondary {\n          font-size: 12px;\n          line-height: 1.7;\n        }\n\n        .secondary a {\n          color: var(--secondary-text-color);\n        }\n\n        .date {\n          margin: 8px 0;\n          padding: 0 16px;\n        }\n\n        .icon-message {\n          display: flex;\n          align-items: center;\n        }\n\n        .no-entries {\n          text-align: center;\n          color: var(--secondary-text-color);\n        }\n\n        state-badge {\n          margin-right: 16px;\n          margin-inline-start: initial;\n          flex-shrink: 0;\n          color: var(--state-icon-color);\n          margin-inline-end: 16px;\n          direction: var(--direction);\n        }\n\n        .message {\n          color: var(--primary-text-color);\n        }\n\n        .no-name .message:first-letter {\n          text-transform: capitalize;\n        }\n\n        a {\n          color: var(--primary-color);\n          text-decoration: none;\n        }\n\n        button.link {\n          color: var(--paper-item-icon-color);\n          text-decoration: none;\n        }\n\n        .container {\n          max-height: var(--logbook-max-height);\n        }\n\n        .container,\n        lit-virtualizer {\n          height: 100%;\n        }\n\n        lit-virtualizer {\n          contain: size layout !important;\n        }\n\n        .narrow .entry {\n          line-height: 1.5;\n        }\n\n        .narrow .icon-message state-badge {\n          margin-left: 0;\n          margin-inline-start: 0;\n          margin-inline-end: initial;\n          direction: var(--direction);\n        }\n      `];\n      }\n    }]\n  };\n}, lit__WEBPACK_IMPORTED_MODULE_1__.LitElement);\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFuZWxzL2xvZ2Jvb2svaGEtbG9nYm9vay1yZW5kZXJlci50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFFQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBTUE7QUFRQTs7QUFFQTs7QUFFQTs7QUFJQTtBQURBO0FBQ0E7QUFBQTs7QUFBQTtBQUFBOztBQUFBOzs7QUFBQTs7O0FBQ0E7QUFBQTtBQUFBOzs7OztBQUVBO0FBQUE7QUFBQTs7OztBQUFBOzs7OztBQUVBO0FBQUE7QUFBQTs7OztBQUNBOzs7OztBQUVBO0FBQUE7QUFBQTs7OztBQUFBOzs7OztBQUVBO0FBQUE7QUFBQTtBQUFBOzs7O0FBQ0E7Ozs7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7OztBQUNBOzs7OztBQUVBO0FBQUE7QUFBQTtBQUFBOzs7O0FBQ0E7Ozs7O0FBRUE7QUFBQTtBQUFBO0FBQUE7Ozs7QUFDQTs7Ozs7QUFFQTtBQUFBO0FBQUE7QUFBQTs7OztBQUNBOzs7OztBQUdBOzs7Ozs7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBS0E7Ozs7QUFFQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7Ozs7OztBQUVBO0FBR0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBR0E7QUFHQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQVFBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFFQTtBQUFBO0FBQUE7O0FBQUE7QUFFQTtBQUNBOzs7QUFFQTtBQUFBO0FBQUE7O0FBQUE7QUFFQTtBQUNBO0FBREE7QUFHQTs7OztBQUVBO0FBTUE7QUFDQTtBQUNBO0FBU0E7QUFDQTs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBQ0E7QUFTQTs7OztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7Ozs7QUFFQTtBQUlBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7OztBQUNBO0FBSUE7Ozs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBR0E7QUFDQTtBQVNBOzs7QUFFQTtBQUNBO0FBR0E7QUFDQTs7QUFDQTtBQUlBO0FBQ0E7OztBQUVBO0FBSUE7QUFDQTtBQUdBO0FBSUE7QUFLQTtBQUNBO0FBTUE7QUFFQTs7O0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTs7OztBQUVBO0FBSUE7QUFDQTs7QUFLQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7Ozs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7Ozs7QUFFQTtBQUNBO0FBQ0E7Ozs7O0FBRUE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUExakJBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvcGFuZWxzL2xvZ2Jvb2svaGEtbG9nYm9vay1yZW5kZXJlci50cz8xYTRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcIkBsaXQtbGFicy92aXJ0dWFsaXplclwiO1xuaW1wb3J0IHsgVmlzaWJpbGl0eUNoYW5nZWRFdmVudCB9IGZyb20gXCJAbGl0LWxhYnMvdmlydHVhbGl6ZXIvVmlydHVhbGl6ZXJcIjtcbmltcG9ydCB7XG4gIGNzcyxcbiAgQ1NTUmVzdWx0R3JvdXAsXG4gIGh0bWwsXG4gIExpdEVsZW1lbnQsXG4gIFByb3BlcnR5VmFsdWVzLFxuICBUZW1wbGF0ZVJlc3VsdCxcbn0gZnJvbSBcImxpdFwiO1xuaW1wb3J0IHR5cGUgeyBIYXNzRW50aXR5IH0gZnJvbSBcImhvbWUtYXNzaXN0YW50LWpzLXdlYnNvY2tldFwiO1xuaW1wb3J0IHsgY3VzdG9tRWxlbWVudCwgZXZlbnRPcHRpb25zLCBwcm9wZXJ0eSB9IGZyb20gXCJsaXQvZGVjb3JhdG9yc1wiO1xuaW1wb3J0IHsgY2xhc3NNYXAgfSBmcm9tIFwibGl0L2RpcmVjdGl2ZXMvY2xhc3MtbWFwXCI7XG5pbXBvcnQgeyBmb3JtYXREYXRlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9kYXRldGltZS9mb3JtYXRfZGF0ZVwiO1xuaW1wb3J0IHsgZm9ybWF0VGltZVdpdGhTZWNvbmRzIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9kYXRldGltZS9mb3JtYXRfdGltZVwiO1xuaW1wb3J0IHsgcmVzdG9yZVNjcm9sbCB9IGZyb20gXCIuLi8uLi9jb21tb24vZGVjb3JhdG9ycy9yZXN0b3JlLXNjcm9sbFwiO1xuaW1wb3J0IHsgZmlyZUV2ZW50IH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9kb20vZmlyZV9ldmVudFwiO1xuaW1wb3J0IHsgY29tcHV0ZURvbWFpbiB9IGZyb20gXCIuLi8uLi9jb21tb24vZW50aXR5L2NvbXB1dGVfZG9tYWluXCI7XG5pbXBvcnQgeyBpc0NvbXBvbmVudExvYWRlZCB9IGZyb20gXCIuLi8uLi9jb21tb24vY29uZmlnL2lzX2NvbXBvbmVudF9sb2FkZWRcIjtcbmltcG9ydCBcIi4uLy4uL2NvbXBvbmVudHMvZW50aXR5L3N0YXRlLWJhZGdlXCI7XG5pbXBvcnQgXCIuLi8uLi9jb21wb25lbnRzL2hhLWNpcmN1bGFyLXByb2dyZXNzXCI7XG5pbXBvcnQgXCIuLi8uLi9jb21wb25lbnRzL2hhLXJlbGF0aXZlLXRpbWVcIjtcbmltcG9ydCB7XG4gIGNyZWF0ZUhpc3RvcmljU3RhdGUsXG4gIGxvY2FsaXplVHJpZ2dlclNvdXJjZSxcbiAgbG9jYWxpemVTdGF0ZU1lc3NhZ2UsXG4gIExvZ2Jvb2tFbnRyeSxcbn0gZnJvbSBcIi4uLy4uL2RhdGEvbG9nYm9va1wiO1xuaW1wb3J0IHsgVHJhY2VDb250ZXh0cyB9IGZyb20gXCIuLi8uLi9kYXRhL3RyYWNlXCI7XG5pbXBvcnQge1xuICBoYVN0eWxlLFxuICBoYVN0eWxlU2Nyb2xsYmFyLFxuICBidXR0b25MaW5rU3R5bGUsXG59IGZyb20gXCIuLi8uLi9yZXNvdXJjZXMvc3R5bGVzXCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uLy4uL3R5cGVzXCI7XG5pbXBvcnQgeyBicmFuZHNVcmwgfSBmcm9tIFwiLi4vLi4vdXRpbC9icmFuZHMtdXJsXCI7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIEhBU1NEb21FdmVudHMge1xuICAgIFwiaGFzcy1sb2dib29rLWxpdmVcIjogeyBlbmFibGU6IGJvb2xlYW4gfTtcbiAgfVxufVxuXG5jb25zdCB0cmlnZ2VyRG9tYWlucyA9IFtcInNjcmlwdFwiLCBcImF1dG9tYXRpb25cIl07XG5cbmNvbnN0IGhhc0NvbnRleHQgPSAoaXRlbTogTG9nYm9va0VudHJ5KSA9PlxuICBpdGVtLmNvbnRleHRfZXZlbnRfdHlwZSB8fCBpdGVtLmNvbnRleHRfc3RhdGUgfHwgaXRlbS5jb250ZXh0X21lc3NhZ2U7XG5jb25zdCBzdHJpcEVudGl0eUlkID0gKG1lc3NhZ2U6IHN0cmluZywgZW50aXR5SWQ/OiBzdHJpbmcpID0+XG4gIGVudGl0eUlkID8gbWVzc2FnZS5yZXBsYWNlKGVudGl0eUlkLCBcIiBcIikgOiBtZXNzYWdlO1xuXG5AY3VzdG9tRWxlbWVudChcImhhLWxvZ2Jvb2stcmVuZGVyZXJcIilcbmNsYXNzIEhhTG9nYm9va1JlbmRlcmVyIGV4dGVuZHMgTGl0RWxlbWVudCB7XG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIGhhc3MhOiBIb21lQXNzaXN0YW50O1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSkgcHVibGljIHVzZXJJZFRvTmFtZSA9IHt9O1xuXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogZmFsc2UgfSlcbiAgcHVibGljIHRyYWNlQ29udGV4dHM6IFRyYWNlQ29udGV4dHMgPSB7fTtcblxuICBAcHJvcGVydHkoeyBhdHRyaWJ1dGU6IGZhbHNlIH0pIHB1YmxpYyBlbnRyaWVzOiBMb2dib29rRW50cnlbXSA9IFtdO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4sIGF0dHJpYnV0ZTogXCJuYXJyb3dcIiB9KVxuICBwdWJsaWMgbmFycm93ID0gZmFsc2U7XG5cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiwgYXR0cmlidXRlOiBcInZpcnR1YWxpemVcIiwgcmVmbGVjdDogdHJ1ZSB9KVxuICBwdWJsaWMgdmlydHVhbGl6ZSA9IGZhbHNlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4sIGF0dHJpYnV0ZTogXCJuby1pY29uXCIgfSlcbiAgcHVibGljIG5vSWNvbiA9IGZhbHNlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4sIGF0dHJpYnV0ZTogXCJuby1uYW1lXCIgfSlcbiAgcHVibGljIG5vTmFtZSA9IGZhbHNlO1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IEJvb2xlYW4sIGF0dHJpYnV0ZTogXCJyZWxhdGl2ZS10aW1lXCIgfSlcbiAgcHVibGljIHJlbGF0aXZlVGltZSA9IGZhbHNlO1xuXG4gIC8vIEB0cy1pZ25vcmVcbiAgQHJlc3RvcmVTY3JvbGwoXCIuY29udGFpbmVyXCIpIHByaXZhdGUgX3NhdmVkU2Nyb2xsUG9zPzogbnVtYmVyO1xuXG4gIHByb3RlY3RlZCBzaG91bGRVcGRhdGUoY2hhbmdlZFByb3BzOiBQcm9wZXJ0eVZhbHVlczx0aGlzPikge1xuICAgIGNvbnN0IG9sZEhhc3MgPSBjaGFuZ2VkUHJvcHMuZ2V0KFwiaGFzc1wiKSBhcyBIb21lQXNzaXN0YW50IHwgdW5kZWZpbmVkO1xuICAgIGNvbnN0IGxhbmd1YWdlQ2hhbmdlZCA9XG4gICAgICBvbGRIYXNzID09PSB1bmRlZmluZWQgfHwgb2xkSGFzcy5sb2NhbGUgIT09IHRoaXMuaGFzcy5sb2NhbGU7XG5cbiAgICByZXR1cm4gKFxuICAgICAgY2hhbmdlZFByb3BzLmhhcyhcImVudHJpZXNcIikgfHxcbiAgICAgIGNoYW5nZWRQcm9wcy5oYXMoXCJ0cmFjZUNvbnRleHRzXCIpIHx8XG4gICAgICBsYW5ndWFnZUNoYW5nZWRcbiAgICApO1xuICB9XG5cbiAgcHJvdGVjdGVkIHJlbmRlcigpOiBUZW1wbGF0ZVJlc3VsdCB7XG4gICAgaWYgKCF0aGlzLmVudHJpZXM/Lmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGh0bWxgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXIgbm8tZW50cmllc1wiPlxuICAgICAgICAgICR7dGhpcy5oYXNzLmxvY2FsaXplKFwidWkuY29tcG9uZW50cy5sb2dib29rLmVudHJpZXNfbm90X2ZvdW5kXCIpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIGA7XG4gICAgfVxuXG4gICAgcmV0dXJuIGh0bWxgXG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwiY29udGFpbmVyIGhhLXNjcm9sbGJhciAke2NsYXNzTWFwKHtcbiAgICAgICAgICBuYXJyb3c6IHRoaXMubmFycm93LFxuICAgICAgICAgIFwibm8tbmFtZVwiOiB0aGlzLm5vTmFtZSxcbiAgICAgICAgICBcIm5vLWljb25cIjogdGhpcy5ub0ljb24sXG4gICAgICAgIH0pfVwiXG4gICAgICAgIEBzY3JvbGw9JHt0aGlzLl9zYXZlU2Nyb2xsUG9zfVxuICAgICAgPlxuICAgICAgICAke3RoaXMudmlydHVhbGl6ZVxuICAgICAgICAgID8gaHRtbGA8bGl0LXZpcnR1YWxpemVyXG4gICAgICAgICAgICAgIEB2aXNpYmlsaXR5Q2hhbmdlZD0ke3RoaXMuX3Zpc2liaWxpdHlDaGFuZ2VkfVxuICAgICAgICAgICAgICBzY3JvbGxlclxuICAgICAgICAgICAgICBjbGFzcz1cImhhLXNjcm9sbGJhclwiXG4gICAgICAgICAgICAgIC5pdGVtcz0ke3RoaXMuZW50cmllc31cbiAgICAgICAgICAgICAgLnJlbmRlckl0ZW09JHt0aGlzLl9yZW5kZXJMb2dib29rSXRlbX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgIDwvbGl0LXZpcnR1YWxpemVyPmBcbiAgICAgICAgICA6IHRoaXMuZW50cmllcy5tYXAoKGl0ZW0sIGluZGV4KSA9PlxuICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJMb2dib29rSXRlbShpdGVtLCBpbmRleClcbiAgICAgICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVuZGVyTG9nYm9va0l0ZW0gPSAoXG4gICAgaXRlbTogTG9nYm9va0VudHJ5LFxuICAgIGluZGV4OiBudW1iZXJcbiAgKTogVGVtcGxhdGVSZXN1bHQgPT4ge1xuICAgIGlmICghaXRlbSB8fCBpbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gaHRtbGBgO1xuICAgIH1cbiAgICBjb25zdCBwcmV2aW91cyA9IHRoaXMuZW50cmllc1tpbmRleCAtIDFdO1xuICAgIGNvbnN0IHNlZW5FbnRpdHlJZHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgY3VycmVudFN0YXRlT2JqID0gaXRlbS5lbnRpdHlfaWRcbiAgICAgID8gdGhpcy5oYXNzLnN0YXRlc1tpdGVtLmVudGl0eV9pZF1cbiAgICAgIDogdW5kZWZpbmVkO1xuICAgIGNvbnN0IGhpc3RvcmljU3RhdGVPYmogPSBjdXJyZW50U3RhdGVPYmpcbiAgICAgID8gY3JlYXRlSGlzdG9yaWNTdGF0ZShjdXJyZW50U3RhdGVPYmosIGl0ZW0uc3RhdGUhKVxuICAgICAgOiB1bmRlZmluZWQ7XG4gICAgY29uc3QgZG9tYWluID0gaXRlbS5lbnRpdHlfaWRcbiAgICAgID8gY29tcHV0ZURvbWFpbihpdGVtLmVudGl0eV9pZClcbiAgICAgIDogLy8gRG9tYWluIGlzIHRoZXJlIGlmIHRoZXJlIGlzIG5vIGVudGl0eSBJRC5cbiAgICAgICAgaXRlbS5kb21haW4hO1xuICAgIGNvbnN0IG92ZXJyaWRlSW1hZ2UgPVxuICAgICAgIWhpc3RvcmljU3RhdGVPYmogJiZcbiAgICAgICFpdGVtLmljb24gJiZcbiAgICAgICFpdGVtLnN0YXRlICYmXG4gICAgICBkb21haW4gJiZcbiAgICAgIGlzQ29tcG9uZW50TG9hZGVkKHRoaXMuaGFzcywgZG9tYWluKVxuICAgICAgICA/IGJyYW5kc1VybCh7XG4gICAgICAgICAgICBkb21haW46IGRvbWFpbiEsXG4gICAgICAgICAgICB0eXBlOiBcImljb25cIixcbiAgICAgICAgICAgIHVzZUZhbGxiYWNrOiB0cnVlLFxuICAgICAgICAgICAgZGFya09wdGltaXplZDogdGhpcy5oYXNzLnRoZW1lcz8uZGFya01vZGUsXG4gICAgICAgICAgfSlcbiAgICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gaHRtbGBcbiAgICAgIDxkaXYgY2xhc3M9XCJlbnRyeS1jb250YWluZXJcIj5cbiAgICAgICAgJHtpbmRleCA9PT0gMCB8fFxuICAgICAgICAoaXRlbT8ud2hlbiAmJlxuICAgICAgICAgIHByZXZpb3VzPy53aGVuICYmXG4gICAgICAgICAgbmV3IERhdGUoaXRlbS53aGVuICogMTAwMCkudG9EYXRlU3RyaW5nKCkgIT09XG4gICAgICAgICAgICBuZXcgRGF0ZShwcmV2aW91cy53aGVuICogMTAwMCkudG9EYXRlU3RyaW5nKCkpXG4gICAgICAgICAgPyBodG1sYFxuICAgICAgICAgICAgICA8aDQgY2xhc3M9XCJkYXRlXCI+XG4gICAgICAgICAgICAgICAgJHtmb3JtYXREYXRlKG5ldyBEYXRlKGl0ZW0ud2hlbiAqIDEwMDApLCB0aGlzLmhhc3MubG9jYWxlKX1cbiAgICAgICAgICAgICAgPC9oND5cbiAgICAgICAgICAgIGBcbiAgICAgICAgICA6IGh0bWxgYH1cblxuICAgICAgICA8ZGl2IGNsYXNzPVwiZW50cnkgJHtjbGFzc01hcCh7IFwibm8tZW50aXR5XCI6ICFpdGVtLmVudGl0eV9pZCB9KX1cIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiaWNvbi1tZXNzYWdlXCI+XG4gICAgICAgICAgICAkeyF0aGlzLm5vSWNvblxuICAgICAgICAgICAgICA/IGh0bWxgXG4gICAgICAgICAgICAgICAgICA8c3RhdGUtYmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgLmhhc3M9JHt0aGlzLmhhc3N9XG4gICAgICAgICAgICAgICAgICAgIC5vdmVycmlkZUljb249JHtpdGVtLmljb259XG4gICAgICAgICAgICAgICAgICAgIC5vdmVycmlkZUltYWdlPSR7b3ZlcnJpZGVJbWFnZX1cbiAgICAgICAgICAgICAgICAgICAgLnN0YXRlT2JqPSR7aXRlbS5pY29uID8gdW5kZWZpbmVkIDogaGlzdG9yaWNTdGF0ZU9ian1cbiAgICAgICAgICAgICAgICAgICAgLnN0YXRlQ29sb3I9JHtmYWxzZX1cbiAgICAgICAgICAgICAgICAgID48L3N0YXRlLWJhZGdlPlxuICAgICAgICAgICAgICAgIGBcbiAgICAgICAgICAgICAgOiBcIlwifVxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtcmVsYXRpdmVfdGltZVwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZVwiPlxuICAgICAgICAgICAgICAgICR7IXRoaXMubm9OYW1lIC8vIFVzZWQgZm9yIG1vcmUtaW5mbyBwYW5lbCAoc2luZ2xlIGVudGl0eSBjYXNlKVxuICAgICAgICAgICAgICAgICAgPyB0aGlzLl9yZW5kZXJFbnRpdHkoaXRlbS5lbnRpdHlfaWQsIGl0ZW0ubmFtZSlcbiAgICAgICAgICAgICAgICAgIDogXCJcIn1cbiAgICAgICAgICAgICAgICAke3RoaXMuX3JlbmRlck1lc3NhZ2UoXG4gICAgICAgICAgICAgICAgICBpdGVtLFxuICAgICAgICAgICAgICAgICAgc2VlbkVudGl0eUlkcyxcbiAgICAgICAgICAgICAgICAgIGRvbWFpbixcbiAgICAgICAgICAgICAgICAgIGhpc3RvcmljU3RhdGVPYmpcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICR7dGhpcy5fcmVuZGVyQ29udGV4dE1lc3NhZ2UoaXRlbSwgc2VlbkVudGl0eUlkcyl9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic2Vjb25kYXJ5XCI+XG4gICAgICAgICAgICAgICAgPHNwYW5cbiAgICAgICAgICAgICAgICAgID4ke2Zvcm1hdFRpbWVXaXRoU2Vjb25kcyhcbiAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUoaXRlbS53aGVuICogMTAwMCksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzcy5sb2NhbGVcbiAgICAgICAgICAgICAgICAgICl9PC9zcGFuXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIC1cbiAgICAgICAgICAgICAgICA8aGEtcmVsYXRpdmUtdGltZVxuICAgICAgICAgICAgICAgICAgLmhhc3M9JHt0aGlzLmhhc3N9XG4gICAgICAgICAgICAgICAgICAuZGF0ZXRpbWU9JHtpdGVtLndoZW4gKiAxMDAwfVxuICAgICAgICAgICAgICAgICAgY2FwaXRhbGl6ZVxuICAgICAgICAgICAgICAgID48L2hhLXJlbGF0aXZlLXRpbWU+XG4gICAgICAgICAgICAgICAgJHtpdGVtLmNvbnRleHRfdXNlcl9pZCA/IGh0bWxgJHt0aGlzLl9yZW5kZXJVc2VyKGl0ZW0pfWAgOiBcIlwifVxuICAgICAgICAgICAgICAgICR7dHJpZ2dlckRvbWFpbnMuaW5jbHVkZXMoaXRlbS5kb21haW4hKSAmJlxuICAgICAgICAgICAgICAgIGl0ZW0uY29udGV4dF9pZCEgaW4gdGhpcy50cmFjZUNvbnRleHRzXG4gICAgICAgICAgICAgICAgICA/IGh0bWxgXG4gICAgICAgICAgICAgICAgICAgICAgLVxuICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICBocmVmPSR7YC9jb25maWcvJHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFjZUNvbnRleHRzW2l0ZW0uY29udGV4dF9pZCFdLmRvbWFpblxuICAgICAgICAgICAgICAgICAgICAgICAgfS90cmFjZS8ke1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYWNlQ29udGV4dHNbaXRlbS5jb250ZXh0X2lkIV0uZG9tYWluID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgICBcInNjcmlwdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBgc2NyaXB0LiR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhY2VDb250ZXh0c1tpdGVtLmNvbnRleHRfaWQhXS5pdGVtX2lkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9YFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy50cmFjZUNvbnRleHRzW2l0ZW0uY29udGV4dF9pZCFdLml0ZW1faWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0/cnVuX2lkPSR7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhY2VDb250ZXh0c1tpdGVtLmNvbnRleHRfaWQhXS5ydW5faWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICAgICAgICAgICAgQGNsaWNrPSR7dGhpcy5fY2xvc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICA+JHt0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwidWkuY29tcG9uZW50cy5sb2dib29rLnNob3dfdHJhY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKX08L2FcbiAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIGBcbiAgICAgICAgICAgICAgICAgIDogXCJcIn1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuICB9O1xuXG4gIEBldmVudE9wdGlvbnMoeyBwYXNzaXZlOiB0cnVlIH0pXG4gIHByaXZhdGUgX3NhdmVTY3JvbGxQb3MoZTogRXZlbnQpIHtcbiAgICB0aGlzLl9zYXZlZFNjcm9sbFBvcyA9IChlLnRhcmdldCBhcyBIVE1MRGl2RWxlbWVudCkuc2Nyb2xsVG9wO1xuICB9XG5cbiAgQGV2ZW50T3B0aW9ucyh7IHBhc3NpdmU6IHRydWUgfSlcbiAgcHJpdmF0ZSBfdmlzaWJpbGl0eUNoYW5nZWQoZTogVmlzaWJpbGl0eUNoYW5nZWRFdmVudCkge1xuICAgIGZpcmVFdmVudCh0aGlzLCBcImhhc3MtbG9nYm9vay1saXZlXCIsIHtcbiAgICAgIGVuYWJsZTogZS5maXJzdCA9PT0gMCxcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX3JlbmRlck1lc3NhZ2UoXG4gICAgaXRlbTogTG9nYm9va0VudHJ5LFxuICAgIHNlZW5FbnRpdHlJZHM6IHN0cmluZ1tdLFxuICAgIGRvbWFpbj86IHN0cmluZyxcbiAgICBoaXN0b3JpY1N0YXRlT2JqPzogSGFzc0VudGl0eVxuICApIHtcbiAgICBpZiAoaXRlbS5lbnRpdHlfaWQpIHtcbiAgICAgIGlmIChpdGVtLnN0YXRlKSB7XG4gICAgICAgIHJldHVybiBoaXN0b3JpY1N0YXRlT2JqXG4gICAgICAgICAgPyBsb2NhbGl6ZVN0YXRlTWVzc2FnZShcbiAgICAgICAgICAgICAgdGhpcy5oYXNzLFxuICAgICAgICAgICAgICB0aGlzLmhhc3MubG9jYWxpemUsXG4gICAgICAgICAgICAgIGl0ZW0uc3RhdGUsXG4gICAgICAgICAgICAgIGhpc3RvcmljU3RhdGVPYmosXG4gICAgICAgICAgICAgIGRvbWFpbiFcbiAgICAgICAgICAgIClcbiAgICAgICAgICA6IGl0ZW0uc3RhdGU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgaXRlbUhhc0NvbnRleHQgPSBoYXNDb250ZXh0KGl0ZW0pO1xuICAgIGxldCBtZXNzYWdlID0gaXRlbS5tZXNzYWdlO1xuICAgIGlmICh0cmlnZ2VyRG9tYWlucy5pbmNsdWRlcyhkb21haW4hKSAmJiBpdGVtLnNvdXJjZSkge1xuICAgICAgaWYgKGl0ZW1IYXNDb250ZXh0KSB7XG4gICAgICAgIC8vIFRoZXNlIGRvbWFpbnMgaW5jbHVkZSB0aGUgdHJpZ2dlciBzb3VyY2UgaW4gdGhlIG1lc3NhZ2VcbiAgICAgICAgLy8gYnV0IGlmIHdlIGhhdmUgdGhlIGNvbnRleHQgd2Ugd2FudCB0byBkaXNwbGF5IHRoYXQgaW5zdGVhZFxuICAgICAgICAvLyBhcyBvdGhlcndpc2Ugd2UgZGlzcGxheSBkdXBsaWNhdGUgdHJpZ2dlcnNcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICB9XG4gICAgICBtZXNzYWdlID0gbG9jYWxpemVUcmlnZ2VyU291cmNlKHRoaXMuaGFzcy5sb2NhbGl6ZSwgaXRlbS5zb3VyY2UpO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZVxuICAgICAgPyB0aGlzLl9mb3JtYXRNZXNzYWdlV2l0aFBvc3NpYmxlRW50aXR5KFxuICAgICAgICAgIGl0ZW1IYXNDb250ZXh0XG4gICAgICAgICAgICA/IHN0cmlwRW50aXR5SWQobWVzc2FnZSwgaXRlbS5jb250ZXh0X2VudGl0eV9pZClcbiAgICAgICAgICAgIDogbWVzc2FnZSxcbiAgICAgICAgICBzZWVuRW50aXR5SWRzLFxuICAgICAgICAgIHVuZGVmaW5lZFxuICAgICAgICApXG4gICAgICA6IFwiXCI7XG4gIH1cblxuICBwcml2YXRlIF9yZW5kZXJVc2VyKGl0ZW06IExvZ2Jvb2tFbnRyeSkge1xuICAgIGNvbnN0IGl0ZW1fdXNlcm5hbWUgPVxuICAgICAgaXRlbS5jb250ZXh0X3VzZXJfaWQgJiYgdGhpcy51c2VySWRUb05hbWVbaXRlbS5jb250ZXh0X3VzZXJfaWRdO1xuICAgIGlmIChpdGVtX3VzZXJuYW1lKSB7XG4gICAgICByZXR1cm4gYC0gJHtpdGVtX3VzZXJuYW1lfWA7XG4gICAgfVxuICAgIHJldHVybiBcIlwiO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVuZGVyVW5zZWVuQ29udGV4dFNvdXJjZUVudGl0eShcbiAgICBpdGVtOiBMb2dib29rRW50cnksXG4gICAgc2VlbkVudGl0eUlkczogc3RyaW5nW11cbiAgKSB7XG4gICAgaWYgKFxuICAgICAgIWl0ZW0uY29udGV4dF9lbnRpdHlfaWQgfHxcbiAgICAgIHNlZW5FbnRpdHlJZHMuaW5jbHVkZXMoaXRlbS5jb250ZXh0X2VudGl0eV9pZCEpXG4gICAgKSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgLy8gV2UgZG9uJ3Qga25vdyB3aGF0IGNhdXNlZCB0aGlzIGVudGl0eVxuICAgIC8vIHRvIGJlIGluY2x1ZGVkIHNpbmNlIGl0cyBhbiBpbnRlZ3JhdGlvblxuICAgIC8vIGRlc2NyaWJlZCBldmVudC5cbiAgICByZXR1cm4gaHRtbGAgKCR7dGhpcy5fcmVuZGVyRW50aXR5KFxuICAgICAgaXRlbS5jb250ZXh0X2VudGl0eV9pZCxcbiAgICAgIGl0ZW0uY29udGV4dF9lbnRpdHlfaWRfbmFtZVxuICAgICl9KWA7XG4gIH1cblxuICBwcml2YXRlIF9yZW5kZXJDb250ZXh0TWVzc2FnZShpdGVtOiBMb2dib29rRW50cnksIHNlZW5FbnRpdHlJZHM6IHN0cmluZ1tdKSB7XG4gICAgLy8gU3RhdGUgY2hhbmdlXG4gICAgaWYgKGl0ZW0uY29udGV4dF9zdGF0ZSkge1xuICAgICAgY29uc3QgaGlzdG9yaWNTdGF0ZU9iaiA9XG4gICAgICAgIGl0ZW0uY29udGV4dF9lbnRpdHlfaWQgJiYgaXRlbS5jb250ZXh0X2VudGl0eV9pZCBpbiB0aGlzLmhhc3Muc3RhdGVzXG4gICAgICAgICAgPyBjcmVhdGVIaXN0b3JpY1N0YXRlKFxuICAgICAgICAgICAgICB0aGlzLmhhc3Muc3RhdGVzW2l0ZW0uY29udGV4dF9lbnRpdHlfaWRdLFxuICAgICAgICAgICAgICBpdGVtLmNvbnRleHRfc3RhdGVcbiAgICAgICAgICAgIClcbiAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybiBodG1sYCR7dGhpcy5oYXNzLmxvY2FsaXplKFxuICAgICAgICBcInVpLmNvbXBvbmVudHMubG9nYm9vay50cmlnZ2VyZWRfYnlfc3RhdGVfb2ZcIlxuICAgICAgKX1cbiAgICAgICR7dGhpcy5fcmVuZGVyRW50aXR5KGl0ZW0uY29udGV4dF9lbnRpdHlfaWQsIGl0ZW0uY29udGV4dF9lbnRpdHlfaWRfbmFtZSl9XG4gICAgICAke2hpc3RvcmljU3RhdGVPYmpcbiAgICAgICAgPyBsb2NhbGl6ZVN0YXRlTWVzc2FnZShcbiAgICAgICAgICAgIHRoaXMuaGFzcyxcbiAgICAgICAgICAgIHRoaXMuaGFzcy5sb2NhbGl6ZSxcbiAgICAgICAgICAgIGl0ZW0uY29udGV4dF9zdGF0ZSxcbiAgICAgICAgICAgIGhpc3RvcmljU3RhdGVPYmosXG4gICAgICAgICAgICBjb21wdXRlRG9tYWluKGl0ZW0uY29udGV4dF9lbnRpdHlfaWQhKVxuICAgICAgICAgIClcbiAgICAgICAgOiBpdGVtLmNvbnRleHRfc3RhdGV9YDtcbiAgICB9XG4gICAgLy8gU2VydmljZSBjYWxsXG4gICAgaWYgKGl0ZW0uY29udGV4dF9ldmVudF90eXBlID09PSBcImNhbGxfc2VydmljZVwiKSB7XG4gICAgICByZXR1cm4gaHRtbGAke3RoaXMuaGFzcy5sb2NhbGl6ZShcbiAgICAgICAgXCJ1aS5jb21wb25lbnRzLmxvZ2Jvb2sudHJpZ2dlcmVkX2J5X3NlcnZpY2VcIlxuICAgICAgKX1cbiAgICAgICR7aXRlbS5jb250ZXh0X2RvbWFpbn0uJHtpdGVtLmNvbnRleHRfc2VydmljZX1gO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICAhaXRlbS5jb250ZXh0X21lc3NhZ2UgfHxcbiAgICAgIHNlZW5FbnRpdHlJZHMuaW5jbHVkZXMoaXRlbS5jb250ZXh0X2VudGl0eV9pZCEpXG4gICAgKSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgLy8gQXV0b21hdGlvbiBvciBzY3JpcHRcbiAgICBpZiAoXG4gICAgICBpdGVtLmNvbnRleHRfZXZlbnRfdHlwZSA9PT0gXCJhdXRvbWF0aW9uX3RyaWdnZXJlZFwiIHx8XG4gICAgICBpdGVtLmNvbnRleHRfZXZlbnRfdHlwZSA9PT0gXCJzY3JpcHRfc3RhcnRlZFwiXG4gICAgKSB7XG4gICAgICAvLyBjb250ZXh0X3NvdXJjZSBpcyBhdmFpbGFibGUgaW4gMjAyMi42IGFuZCBsYXRlclxuICAgICAgY29uc3QgdHJpZ2dlck1zZyA9IGl0ZW0uY29udGV4dF9zb3VyY2VcbiAgICAgICAgPyBpdGVtLmNvbnRleHRfc291cmNlXG4gICAgICAgIDogaXRlbS5jb250ZXh0X21lc3NhZ2UucmVwbGFjZShcInRyaWdnZXJlZCBieSBcIiwgXCJcIik7XG4gICAgICBjb25zdCBjb250ZXh0VHJpZ2dlclNvdXJjZSA9IGxvY2FsaXplVHJpZ2dlclNvdXJjZShcbiAgICAgICAgdGhpcy5oYXNzLmxvY2FsaXplLFxuICAgICAgICB0cmlnZ2VyTXNnXG4gICAgICApO1xuICAgICAgcmV0dXJuIGh0bWxgJHt0aGlzLmhhc3MubG9jYWxpemUoXG4gICAgICAgIGl0ZW0uY29udGV4dF9ldmVudF90eXBlID09PSBcImF1dG9tYXRpb25fdHJpZ2dlcmVkXCJcbiAgICAgICAgICA/IFwidWkuY29tcG9uZW50cy5sb2dib29rLnRyaWdnZXJlZF9ieV9hdXRvbWF0aW9uXCJcbiAgICAgICAgICA6IFwidWkuY29tcG9uZW50cy5sb2dib29rLnRyaWdnZXJlZF9ieV9zY3JpcHRcIlxuICAgICAgKX1cbiAgICAgICR7dGhpcy5fcmVuZGVyRW50aXR5KGl0ZW0uY29udGV4dF9lbnRpdHlfaWQsIGl0ZW0uY29udGV4dF9lbnRpdHlfaWRfbmFtZSl9XG4gICAgICAke2l0ZW0uY29udGV4dF9tZXNzYWdlXG4gICAgICAgID8gdGhpcy5fZm9ybWF0TWVzc2FnZVdpdGhQb3NzaWJsZUVudGl0eShcbiAgICAgICAgICAgIGNvbnRleHRUcmlnZ2VyU291cmNlLFxuICAgICAgICAgICAgc2VlbkVudGl0eUlkc1xuICAgICAgICAgIClcbiAgICAgICAgOiBcIlwifWA7XG4gICAgfVxuICAgIC8vIEdlbmVyaWMgZXh0ZXJuYWxseSBkZXNjcmliZWQgbG9nYm9vayBwbGF0Zm9ybVxuICAgIC8vIFRoZXNlIGFyZSBub3QgbG9jYWxpemFibGVcbiAgICByZXR1cm4gaHRtbGAgJHt0aGlzLmhhc3MubG9jYWxpemUoXCJ1aS5jb21wb25lbnRzLmxvZ2Jvb2sudHJpZ2dlcmVkX2J5XCIpfVxuICAgICR7aXRlbS5jb250ZXh0X25hbWV9XG4gICAgJHt0aGlzLl9mb3JtYXRNZXNzYWdlV2l0aFBvc3NpYmxlRW50aXR5KFxuICAgICAgaXRlbS5jb250ZXh0X21lc3NhZ2UsXG4gICAgICBzZWVuRW50aXR5SWRzLFxuICAgICAgaXRlbS5jb250ZXh0X2VudGl0eV9pZFxuICAgICl9XG4gICAgJHt0aGlzLl9yZW5kZXJVbnNlZW5Db250ZXh0U291cmNlRW50aXR5KGl0ZW0sIHNlZW5FbnRpdHlJZHMpfWA7XG4gIH1cblxuICBwcml2YXRlIF9yZW5kZXJFbnRpdHkoXG4gICAgZW50aXR5SWQ6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgICBlbnRpdHlOYW1lOiBzdHJpbmcgfCB1bmRlZmluZWRcbiAgKSB7XG4gICAgY29uc3QgaGFzU3RhdGUgPSBlbnRpdHlJZCAmJiBlbnRpdHlJZCBpbiB0aGlzLmhhc3Muc3RhdGVzO1xuICAgIGNvbnN0IGRpc3BsYXlOYW1lID1cbiAgICAgIGVudGl0eU5hbWUgfHxcbiAgICAgIChoYXNTdGF0ZVxuICAgICAgICA/IHRoaXMuaGFzcy5zdGF0ZXNbZW50aXR5SWRdLmF0dHJpYnV0ZXMuZnJpZW5kbHlfbmFtZSB8fCBlbnRpdHlJZFxuICAgICAgICA6IGVudGl0eUlkKTtcbiAgICBpZiAoIWhhc1N0YXRlKSB7XG4gICAgICByZXR1cm4gZGlzcGxheU5hbWU7XG4gICAgfVxuICAgIHJldHVybiBodG1sYDxidXR0b25cbiAgICAgIGNsYXNzPVwibGlua1wiXG4gICAgICBAY2xpY2s9JHt0aGlzLl9lbnRpdHlDbGlja2VkfVxuICAgICAgLmVudGl0eUlkPSR7ZW50aXR5SWR9XG4gICAgPlxuICAgICAgJHtkaXNwbGF5TmFtZX1cbiAgICA8L2J1dHRvbj5gO1xuICB9XG5cbiAgcHJpdmF0ZSBfZm9ybWF0TWVzc2FnZVdpdGhQb3NzaWJsZUVudGl0eShcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgc2VlbkVudGl0aWVzOiBzdHJpbmdbXSxcbiAgICBwb3NzaWJsZUVudGl0eT86IHN0cmluZ1xuICApIHtcbiAgICAvL1xuICAgIC8vIEFzIHdlIGFyZSBsb29raW5nIGF0IGEgbG9nKGJvb2spLCB3ZSBhcmUgZG9pbmcgZW50aXR5X2lkXG4gICAgLy8gXCJoaWdobGlnaHRpbmdcIi9cImNvbG9yaXppbmdcIi4gVGhlIGdvYWwgaXMgdG8gbWFrZSBpdCBlYXN5IGZvclxuICAgIC8vIHRoZSB1c2VyIHRvIGFjY2VzcyB0aGUgZW50aXR5IHRoYXQgY2F1c2VkIHRoZSBldmVudC5cbiAgICAvL1xuICAgIC8vIElmIHRoZXJlIGlzIGFuIGVudGl0eV9pZCBpbiB0aGUgbWVzc2FnZSB0aGF0IGlzIGFsc28gaW4gdGhlXG4gICAgLy8gc3RhdGUgbWFjaGluZSwgd2Ugc2VhcmNoIHRoZSBtZXNzYWdlIGZvciB0aGUgZW50aXR5X2lkIGFuZFxuICAgIC8vIHJlcGxhY2UgaXQgd2l0aCBfcmVuZGVyRW50aXR5XG4gICAgLy9cbiAgICBpZiAobWVzc2FnZS5pbmRleE9mKFwiLlwiKSAhPT0gLTEpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2VQYXJ0cyA9IG1lc3NhZ2Uuc3BsaXQoXCIgXCIpO1xuICAgICAgZm9yIChsZXQgaSA9IDAsIHNpemUgPSBtZXNzYWdlUGFydHMubGVuZ3RoOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgIGlmIChtZXNzYWdlUGFydHNbaV0gaW4gdGhpcy5oYXNzLnN0YXRlcykge1xuICAgICAgICAgIGNvbnN0IGVudGl0eUlkID0gbWVzc2FnZVBhcnRzW2ldO1xuICAgICAgICAgIGlmIChzZWVuRW50aXRpZXMuaW5jbHVkZXMoZW50aXR5SWQpKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VlbkVudGl0aWVzLnB1c2goZW50aXR5SWQpO1xuICAgICAgICAgIGNvbnN0IG1lc3NhZ2VFbmQgPSBtZXNzYWdlUGFydHMuc3BsaWNlKGkpO1xuICAgICAgICAgIG1lc3NhZ2VFbmQuc2hpZnQoKTsgLy8gcmVtb3ZlIHRoZSBlbnRpdHlcbiAgICAgICAgICByZXR1cm4gaHRtbGAke21lc3NhZ2VQYXJ0cy5qb2luKFwiIFwiKX1cbiAgICAgICAgICAke3RoaXMuX3JlbmRlckVudGl0eShcbiAgICAgICAgICAgIGVudGl0eUlkLFxuICAgICAgICAgICAgdGhpcy5oYXNzLnN0YXRlc1tlbnRpdHlJZF0uYXR0cmlidXRlcy5mcmllbmRseV9uYW1lXG4gICAgICAgICAgKX1cbiAgICAgICAgICAke21lc3NhZ2VFbmQuam9pbihcIiBcIil9YDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICAvL1xuICAgIC8vIFdoZW4gd2UgaGF2ZSBhIG1lc3NhZ2UgaGFzIGEgc3BlY2lmaWMgZW50aXR5X2lkIGF0dGFjaGVkIHRvXG4gICAgLy8gaXQsIGFuZCB0aGUgZW50aXR5X2lkIGlzIG5vdCBpbiB0aGUgbWVzc2FnZSwgd2UgbG9va1xuICAgIC8vIGZvciB0aGUgZnJpZW5kbHkgbmFtZSBvZiB0aGUgZW50aXR5IGFuZCByZXBsYWNlIHRoYXQgd2l0aFxuICAgIC8vIF9yZW5kZXJFbnRpdHkgaWYgaXRzIHRoZXJlIHNvIHRoZSB1c2VyIGNhbiBxdWlja2x5IGdldCB0b1xuICAgIC8vIHRoYXQgZW50aXR5LlxuICAgIC8vXG4gICAgaWYgKHBvc3NpYmxlRW50aXR5ICYmIHBvc3NpYmxlRW50aXR5IGluIHRoaXMuaGFzcy5zdGF0ZXMpIHtcbiAgICAgIGNvbnN0IHBvc3NpYmxlRW50aXR5TmFtZSA9XG4gICAgICAgIHRoaXMuaGFzcy5zdGF0ZXNbcG9zc2libGVFbnRpdHldLmF0dHJpYnV0ZXMuZnJpZW5kbHlfbmFtZTtcbiAgICAgIGlmIChwb3NzaWJsZUVudGl0eU5hbWUgJiYgbWVzc2FnZS5lbmRzV2l0aChwb3NzaWJsZUVudGl0eU5hbWUpKSB7XG4gICAgICAgIGlmIChzZWVuRW50aXRpZXMuaW5jbHVkZXMocG9zc2libGVFbnRpdHkpKSB7XG4gICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgc2VlbkVudGl0aWVzLnB1c2gocG9zc2libGVFbnRpdHkpO1xuICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5zdWJzdHJpbmcoXG4gICAgICAgICAgMCxcbiAgICAgICAgICBtZXNzYWdlLmxlbmd0aCAtIHBvc3NpYmxlRW50aXR5TmFtZS5sZW5ndGhcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGh0bWxgJHttZXNzYWdlfVxuICAgICAgICAke3RoaXMuX3JlbmRlckVudGl0eShwb3NzaWJsZUVudGl0eSwgcG9zc2libGVFbnRpdHlOYW1lKX1gO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxuXG4gIHByaXZhdGUgX2VudGl0eUNsaWNrZWQoZXY6IEV2ZW50KSB7XG4gICAgY29uc3QgZW50aXR5SWQgPSAoZXYuY3VycmVudFRhcmdldCBhcyBhbnkpLmVudGl0eUlkO1xuICAgIGlmICghZW50aXR5SWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGZpcmVFdmVudCh0aGlzLCBcImhhc3MtbW9yZS1pbmZvXCIsIHtcbiAgICAgIGVudGl0eUlkOiBlbnRpdHlJZCxcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2Nsb3NlKCk6IHZvaWQge1xuICAgIHNldFRpbWVvdXQoKCkgPT4gZmlyZUV2ZW50KHRoaXMsIFwiY2xvc2VkXCIpLCA1MDApO1xuICB9XG5cbiAgc3RhdGljIGdldCBzdHlsZXMoKTogQ1NTUmVzdWx0R3JvdXAge1xuICAgIHJldHVybiBbXG4gICAgICBoYVN0eWxlLFxuICAgICAgaGFTdHlsZVNjcm9sbGJhcixcbiAgICAgIGJ1dHRvbkxpbmtTdHlsZSxcbiAgICAgIGNzc2BcbiAgICAgICAgOmhvc3QoW3ZpcnR1YWxpemVdKSB7XG4gICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB9XG5cbiAgICAgICAgLmVudHJ5LWNvbnRhaW5lciB7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgIH1cblxuICAgICAgICAuZW50cnkge1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgbGluZS1oZWlnaHQ6IDJlbTtcbiAgICAgICAgICBwYWRkaW5nOiA4cHggMTZweDtcbiAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1kaXZpZGVyLWNvbG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5lbnRyeS5uby1lbnRpdHksXG4gICAgICAgIC5uby1uYW1lIC5lbnRyeSB7XG4gICAgICAgICAgY3Vyc29yOiBkZWZhdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLmVudHJ5OmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKHZhcigtLXJnYi1wcmltYXJ5LXRleHQtY29sb3IpLCAwLjA0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5uYXJyb3c6bm90KC5uby1pY29uKSAudGltZSB7XG4gICAgICAgICAgbWFyZ2luLWxlZnQ6IDMycHg7XG4gICAgICAgICAgbWFyZ2luLWlubGluZS1zdGFydDogMzJweDtcbiAgICAgICAgICBtYXJnaW4taW5saW5lLWVuZDogaW5pdGlhbDtcbiAgICAgICAgICBkaXJlY3Rpb246IHZhcigtLWRpcmVjdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAubWVzc2FnZS1yZWxhdGl2ZV90aW1lIHtcbiAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgIH1cblxuICAgICAgICAuc2Vjb25kYXJ5IHtcbiAgICAgICAgICBmb250LXNpemU6IDEycHg7XG4gICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNztcbiAgICAgICAgfVxuXG4gICAgICAgIC5zZWNvbmRhcnkgYSB7XG4gICAgICAgICAgY29sb3I6IHZhcigtLXNlY29uZGFyeS10ZXh0LWNvbG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5kYXRlIHtcbiAgICAgICAgICBtYXJnaW46IDhweCAwO1xuICAgICAgICAgIHBhZGRpbmc6IDAgMTZweDtcbiAgICAgICAgfVxuXG4gICAgICAgIC5pY29uLW1lc3NhZ2Uge1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC5uby1lbnRyaWVzIHtcbiAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgY29sb3I6IHZhcigtLXNlY29uZGFyeS10ZXh0LWNvbG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRlLWJhZGdlIHtcbiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDE2cHg7XG4gICAgICAgICAgbWFyZ2luLWlubGluZS1zdGFydDogaW5pdGlhbDtcbiAgICAgICAgICBmbGV4LXNocmluazogMDtcbiAgICAgICAgICBjb2xvcjogdmFyKC0tc3RhdGUtaWNvbi1jb2xvcik7XG4gICAgICAgICAgbWFyZ2luLWlubGluZS1lbmQ6IDE2cHg7XG4gICAgICAgICAgZGlyZWN0aW9uOiB2YXIoLS1kaXJlY3Rpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLm1lc3NhZ2Uge1xuICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LXRleHQtY29sb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLm5vLW5hbWUgLm1lc3NhZ2U6Zmlyc3QtbGV0dGVyIHtcbiAgICAgICAgICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGEge1xuICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yKTtcbiAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG4gICAgICAgIH1cblxuICAgICAgICBidXR0b24ubGluayB7XG4gICAgICAgICAgY29sb3I6IHZhcigtLXBhcGVyLWl0ZW0taWNvbi1jb2xvcik7XG4gICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICAgICAgICB9XG5cbiAgICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgICAgbWF4LWhlaWdodDogdmFyKC0tbG9nYm9vay1tYXgtaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC5jb250YWluZXIsXG4gICAgICAgIGxpdC12aXJ0dWFsaXplciB7XG4gICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGl0LXZpcnR1YWxpemVyIHtcbiAgICAgICAgICBjb250YWluOiBzaXplIGxheW91dCAhaW1wb3J0YW50O1xuICAgICAgICB9XG5cbiAgICAgICAgLm5hcnJvdyAuZW50cnkge1xuICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjU7XG4gICAgICAgIH1cblxuICAgICAgICAubmFycm93IC5pY29uLW1lc3NhZ2Ugc3RhdGUtYmFkZ2Uge1xuICAgICAgICAgIG1hcmdpbi1sZWZ0OiAwO1xuICAgICAgICAgIG1hcmdpbi1pbmxpbmUtc3RhcnQ6IDA7XG4gICAgICAgICAgbWFyZ2luLWlubGluZS1lbmQ6IGluaXRpYWw7XG4gICAgICAgICAgZGlyZWN0aW9uOiB2YXIoLS1kaXJlY3Rpb24pO1xuICAgICAgICB9XG4gICAgICBgLFxuICAgIF07XG4gIH1cbn1cblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgSFRNTEVsZW1lbnRUYWdOYW1lTWFwIHtcbiAgICBcImhhLWxvZ2Jvb2stcmVuZGVyZXJcIjogSGFMb2dib29rUmVuZGVyZXI7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/panels/logbook/ha-logbook-renderer.ts\n");

/***/ })

}]);